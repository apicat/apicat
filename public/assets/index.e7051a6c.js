var Ds=Object.defineProperty,Ps=Object.defineProperties;var Ss=Object.getOwnPropertyDescriptors;var dt=Object.getOwnPropertySymbols;var ho=Object.prototype.hasOwnProperty,po=Object.prototype.propertyIsEnumerable;var Et=(e,t,s)=>t in e?Ds(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,D=(e,t)=>{for(var s in t||(t={}))ho.call(t,s)&&Et(e,s,t[s]);if(dt)for(var s of dt(t))po.call(t,s)&&Et(e,s,t[s]);return e},Y=(e,t)=>Ps(e,Ss(t));var fo=(e,t)=>{var s={};for(var o in e)ho.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&dt)for(var o of dt(e))t.indexOf(o)<0&&po.call(e,o)&&(s[o]=e[o]);return s};var O=(e,t,s)=>(Et(e,typeof t!="symbol"?t+"":t,s),s);import{aY as Be,o as d,h as g,aZ as Qe,a_ as Xe,j as a,K as ee,a$ as ne,v,Y as $,V as T,$ as p,b0 as js,W as V,r as b,b1 as vt,b2 as Io,b3 as j,b4 as Rs,as as X,at as ie,Z as m,a1 as M,L as ft,aF as xs,aG as Ts,b5 as ae,b6 as Ls,a0 as ce,ak as J,S as mt,b7 as wo,y as et,C as bo,X as B,T as te,U as he,b8 as tt,x as pe,a4 as Os,u as ue,b9 as Ms,ba as Bs,bb as No,a5 as Kt,ap as Ut,bc as Vt,t as ge,bd as $s,p as Me,be as Gt,ar as Tt,aX as Fs,bf as qe,bg as Ks,bh as Us,bi as Re,l as Lt,bj as Ct,bk as Vs,q as Do,m as Gs,i as Hs,a2 as Po,_ as Ys,J as _o,A as zs,a6 as Js,bl as Pe,ax as Ht,bm as qs,bn as Ae,bo as mo,aB as So,aA as jo,M as Ws,bp as Zs,bq as Ro,br as Qs,bs as Xs,bt as en,bu as tn,bv as on,bw as go,aU as sn,bx as nn}from"./vendor.4578470d.js";import{E as fe,a as Yt,b as zt,c as ot,d as yt,e as st,f as Jt,g as $e,h as qt,m as rn,i as an,j as xo,k as cn,l as ln,_ as dn,v as nt,n as un,o as hn,p as pn,q as fn,r as To,s as Lo,t as kt,u as Ot,w as Wt,x as _n,y as mn,z as gn,A as Oo,B as Mo,C as vn,D as yn,F as An}from"./element-plus.ccbabc0c.js";const En=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}};En();const Cn=Be({id:"app.store",state:()=>({isShowLoading:!1}),actions:{showLoading(){this.isShowLoading=!0},hideLoading(){this.isShowLoading=!1}}});var Z=(e,t)=>{const s=e.__vccOpts||e;for(const[o,n]of t)s[o]=n;return s};const kn={},In=e=>(Qe("data-v-2dbca8a7"),e=e(),Xe(),e),wn={class:"vertical-center splash"},bn=In(()=>a("div",{class:"w-full text-center text-light"},[a("svg",{class:"spin",style:{width:"70px"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},[a("path",{id:"p",fill:"#006bff",d:"M94.1 58.8c.6-2.8.9-5.8.9-8.8s-.3-6-.9-8.8l-11.7-.4c-.7-2.6-1.7-5-3-7.3l8-8.5c-3.3-4.9-7.5-9.2-12.5-12.5l-8.5 8c-2.3-1.3-4.7-2.3-7.3-3l-.3-11.6C56 5.3 53 5 50 5s-6 .3-8.8.9l-.4 11.7c-2.6.7-5 1.7-7.3 3l-8.5-8c-4.9 3.3-9.2 7.5-12.5 12.5l8 8.5c-1.3 2.3-2.3 4.7-3 7.3l-11.6.3C5.3 44 5 47 5 50s.3 6 .9 8.8l11.7.4c.7 2.6 1.7 5 3 7.3l-8 8.5c3.3 4.9 7.5 9.2 12.5 12.5l8.5-8c2.3 1.3 4.7 2.3 7.3 3l.4 11.7c2.7.5 5.7.8 8.7.8s6-.3 8.8-.9l.4-11.7c2.6-.7 5-1.7 7.3-3l8.5 8c4.9-3.3 9.2-7.5 12.5-12.5l-8-8.5c1.3-2.3 2.3-4.7 3-7.3l11.6-.3zM50 66.9c-9.3 0-16.9-7.6-16.9-16.9S40.7 33.1 50 33.1 66.9 40.7 66.9 50 59.3 66.9 50 66.9z"})])],-1)),Nn=[bn];function Dn(e,t){return d(),g("div",wn,Nn)}var Pn=Z(kn,[["render",Dn],["__scopeId","data-v-2dbca8a7"]]);const Sn=ee({setup(e){const t=Cn(),{isShowLoading:s}=ne(t);return(o,n)=>(d(),g(V,null,[v(s)?(d(),$(Pn,{key:0})):T("",!0),p(v(js))],64))}}),Bo="/",_u=Bo,We="/login",Zt="/register",it="/home",be={path:"/404"},$o="/project/:project_id",jn=$o,Fo="/project/:project_id/setting",Ko="/project/:project_id/members",Uo="/project/:project_id/params",Vo="/project/:project_id/trash",Qt="preview.project",Xt=`${Qt}.verification`,Ze="preview.document",Rn="/doc/:doc_id",gt=`${Ze}.verification`,eo="document",Te="document.api.edit",Go="/project/:project_id/doc/:node_id/edit",Le="document.api.detail",to="/project/:project_id/doc/:node_id?",Ho="/iteration/:iterate_id",Yo="iteration.document",zo="/iteration/:iterate_id/doc/:node_id/edit",Ie="iteration.document.api.edit",He="iteration.document.api.detail",Jo="/iteration/:iterate_id/doc/:node_id?";var rt="/assets/logo.1c8e1405.svg";function qo(e,t){t=D({isCatch:!0,isShowMessage:!0},t);const s=b(!1),{isCatch:o,isShowMessage:n,msg:i}=t;async function r(c){s.value=!0;try{const l=await e(c)||{};return n&&(i||l.msg)&&fe.success(i||l.msg),l}catch(l){if(o)return{};throw l}finally{s.value=!1}}return[s,r]}const xn="/api",Tn=1e3*10,mu=15;var Ke=(e=>(e[e.OK=0]="OK",e[e.FAIL=-1]="FAIL",e[e.NO_LOGIN=-2]="NO_LOGIN",e[e.NO_PARENT_DIR=-102]="NO_PARENT_DIR",e[e.NO_EXIST_TEAM=-100]="NO_EXIST_TEAM",e[e.INVALID_PREVIEW_SECRET=-103]="INVALID_PREVIEW_SECRET",e[e.NOT_FOUND=-404]="NOT_FOUND",e))(Ke||{});const xe={DIR:0,DOC:1,HTTP:1,OTHER:2,MARKDOWN:3},gu={API:{text:"\u63A5\u53E3\u6587\u6863",key:"api.doc",value:1},DB:{text:"\u6570\u636E\u5E93\u6587\u6863",key:"db.doc",value:2}},Ue={WAIT:"wait",FINISH:"finish",FAIL:"fail"},z={ADMIN:"admin",MANAGER:"manage",DEVELOPER:"write",READER:"read",NONE:"none"},It={MANAGER:0,DEVELOPER:1,READER:2},Ln=[{text:"\u56E2\u961F\u7BA1\u7406\u5458",value:999,key:z.ADMIN},{text:"\u7BA1\u7406\u8005",value:It.MANAGER,key:z.MANAGER},{text:"\u7EF4\u62A4\u8005",value:It.DEVELOPER,key:z.DEVELOPER},{text:"\u9605\u8BFB\u8005",value:It.READER,key:z.READER}],vu=Ln.filter(e=>[z.DEVELOPER,z.READER].indexOf(e.key)!==-1),yu="/static/icon-project.png",Ce={PRIVATE:"private",PUBLIC:"public"},wt=[{text:"\u79C1\u6709",value:0,key:Ce.PRIVATE},{text:"\u516C\u5F00",value:1,key:Ce.PUBLIC}],bt={PRIVATE:0,PUBLIC:1},Ve={ADMIN:0,MANAGER:1,NORMAL:2},On=[{text:"\u7BA1\u7406\u5458",value:Ve.MANAGER},{text:"\u666E\u901A\u6210\u5458",value:Ve.NORMAL}];[Ve.ADMIN,...On];const Wo={baseURL:xn,headers:{Accept:"application/json, text/plain, */*"}};vt.defaults.timeout=Tn;var E=vt.create(Wo);const Mt=vt.create(Wo),Mn=(e={})=>E.post("/email_login",D({},e)),Bn=(e={})=>E.post("/email_register",D({},e)),$n=()=>E.post("/logout"),Au=(e={})=>E.post("/user/change_avatar",e),Fn=(e={})=>E.post("/user/change_profile",D({},e)),Kn=()=>E.get("/user/profile").then(e=>{if(e.data){const{name:t,avatar:s}=e.data;s||(e.data.lastName=Io(t||"\u65E0"))}return e}),Eu=()=>qo((e={})=>E.post("/user/change_password",D({},e))),we=Be({id:"user",state:()=>({token:j.get(j.KEYS.TOKEN)||null,userInfo:j.get(j.KEYS.USER_INFO)||{}}),getters:{isLogin:e=>!!e.token,isAdmin:e=>e.userInfo.authority===Ve.ADMIN,isManager:e=>e.userInfo.authority===Ve.MANAGER,isNormal:e=>e.userInfo.authority===Ve.NORMAL,lastName:e=>Io(e.userInfo.name)},actions:{updateToken(e){j.set(j.KEYS.TOKEN,e),this.token=e},async login(e){try{const t=await Mn(e);return await this.getUserInfo(),this.goHome(),t}catch{}},async register(e){try{const t=await Bn(e);return this.goHome(),t}catch{}},async logout(){j.removeAll([j.KEYS.TOKEN,j.KEYS.USER_INFO,j.KEYS.ACTIVE_PROJECT_GROUP]);try{await $n()}catch{}finally{this.token=null,this.userInfo={},location.href=We}},async getUserInfo(){if(!Rs.exports.isEmpty(this.userInfo))return this.userInfo;try{const{data:e}=await Kn()||{};return j.set(j.KEYS.USER_INFO,e),this.userInfo=e,this.userInfo}catch{}return{}},goHome(e){ke.replace(e||it)},async updateUserInfo(e){await Fn(e),this.$patch({userInfo:{name:e.name,email:e.email,avatar:e.avatar}}),j.set(j.KEYS.USER_INFO,this.userInfo)}}}),Un="modulepreload",vo={},Vn="/",q=function(t,s){return!s||s.length===0?t():Promise.all(s.map(o=>{if(o=`${Vn}${o}`,o in vo)return;vo[o]=!0;const n=o.endsWith(".css"),i=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${i}`))return;const r=document.createElement("link");if(r.rel=n?"stylesheet":Un,n||(r.as="script",r.crossOrigin=""),r.href=o,document.head.appendChild(r),n)return new Promise((c,l)=>{r.addEventListener("load",c),r.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},Gn={class:"flex flex-col border divide-y bg-white"},Hn=ee({props:{menus:{type:Array,default:()=>[]}},setup(e){return(t,s)=>{const o=X("router-link");return d(),g("div",Gn,[(d(!0),g(V,null,ie(e.menus,n=>(d(),$(o,{key:n.name,to:{name:n.name},class:"relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900"},{default:m(()=>[a("span",null,M(n.meta.title),1)]),_:2},1032,["to"]))),128))])}}}),Yn={},zn={class:"flex justify-between flex-col lg:flex-row"},Jn={class:"sidebar-nav flex-none lg:w-64 mb-4 lg:mb-0"},qn={class:"flex-auto lg:ml-4 overflow-hidden"};function Wn(e,t){const s=Hn,o=X("RouterView");return d(),g("div",zn,[a("aside",Jn,[ft(e.$slots,"default",{},()=>[p(s,xs(Ts(e.$attrs)),null,16)])]),a("div",qn,[p(o)])])}var oo=Z(Yn,[["render",Wn]]);const Fe=(e=!0)=>e?window.origin:"",Bt=()=>{},Cu=(e={})=>E.post("/project/create",e),ku=(e={})=>E.post("/project/icon",e),Iu=e=>E.post("/project/remove",{project_id:e}),wu=e=>E.post("/project/quit",{project_id:e}),bu=(e={})=>E.post("/project/add_member",e),Nu=e=>E.get("/project/members",{params:e}),Du=(e,t)=>E.post("/project/remove_member",{project_id:e,user_id:t}),Pu=(e,t)=>E.post("/project/transfer",{project_id:e,user_id:t}),Su=(e={})=>E.post("/project/change_member_authority",e),Zn=(e={})=>E.post("/project/setting",e),Qn=(e,t)=>E.post("/project/share",{project_id:e,share:t}),Xn=e=>E.post("/project/reset_share_secretkey",{project_id:e}),ju=(e={})=>E.post("/doc/restore_api_doc",e),Zo=e=>E.get("/projects/base",{params:{authority:e}}),Ru=()=>Zo([z.MANAGER,z.DEVELOPER,z.READER]),xu=()=>Zo([z.MANAGER,z.DEVELOPER]),Tu=e=>E.get("/projects",{params:{group_id:e==0?"":e}}),ei=e=>E.post("/project_group/create",e),ti=()=>E.get("/project_groups"),oi=e=>E.post("/project_group/remove",{id:e}),si=e=>E.post("/project_group/rename",e),ni=e=>E.post("/project_group/change_order",{ids:e}),ii=(e,t)=>E.get("/project",{params:{project_id:e,token:t}}),ri=(e={project_id:null,iteration_id:null},t)=>E.get("/project",{params:Y(D({},e),{token:t})}),ai=e=>E.get("/project/status",{params:{project_id:e}}),Lu=e=>E.post("/project/change_group",e),Ou=e=>E.get("/doc/trash",{params:{project_id:e}}),Mu=e=>E.get("/project/without_members",{params:{project_id:e}}),yo=(e,t)=>Fe(t)+ae($o)({project_id:e}),ci=(e,t)=>Fe(t)+ae(Fo)({project_id:e}),li=(e,t)=>Fe(t)+ae(Ko)({project_id:e}),di=(e,t)=>Fe(t)+ae(Uo)({project_id:e}),ui=(e,t)=>Fe(t)+ae(Vo)({project_id:e}),Ao={id:0,name:"\u6240\u6709\u9879\u76EE"},Qo=Be({id:"projects",state:()=>({projectGroupList:[],activeGroup:j.get(j.KEYS.ACTIVE_PROJECT_GROUP)||Ao}),getters:{},actions:{async getProjectGroupList(){const{data:e=[]}=await ti()||{};this.projectGroupList=e},switchProjectGroup(e=Ao){j.set(j.KEYS.ACTIVE_PROJECT_GROUP,e),this.activeGroup=e},async addProjectGroup(e){const t=await ei(e);return t&&this.projectGroupList.push(t.data),t},async renameProjectGroup(e){const t=await si(e);if(t){const s=this.projectGroupList.find(o=>o.id==e.id);s.name=e.name}return t},async deleteProjectGroup(e){const t=await oi(e.id);return this.projectGroupList=this.projectGroupList.filter(s=>s.id!==e.id),this.activeGroup.id===e.id&&this.switchProjectGroup(),t},async sortProjectGroup(e,t){const s=this.projectGroupList.splice(e,1)[0];this.projectGroupList.splice(t,0,s),await ni(this.projectGroupList.map(o=>o.id))}}}),hi={data(){return{title:"",isShow:!1,isLoading:!1,isEdit:!1,form:{name:""},categoryInfo:null,rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",trigger:"blur"}}}},watch:{isShow:function(){this.isShow&&(this.title=`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4`),!this.isShow&&this.reset()}},methods:Y(D({},Ls(Qo,["addProjectGroup","renameProjectGroup"])),{show(e){this.isEdit=!!e,e?(this.categoryInfo=e,this.form=D({},e)):this.form.name="",this.isShow=!0,this.focus()},hide(){this.isShow=!1},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.$refs.teamForm.resetFields()},handleSubmit(e){this.$refs[e].validate(t=>t&&this.submit())},submit(){this.isLoading=!0,(this.isEdit?this.renameProjectGroup:this.addProjectGroup)(this.form).then(t=>{this.$Message.success(t.msg||`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4\u6210\u529F!`),this.onCloseBtnClick()}).finally(()=>{this.isLoading=!1}).catch(t=>{})},focus(){setTimeout(()=>this.$refs.input.focus(),200)}})},pi=J(" \u53D6\u6D88 "),fi=J(" \u786E\u5B9A ");function _i(e,t,s,o,n,i){const r=yt,c=Yt,l=zt,_=st,f=ot;return d(),$(f,{modelValue:n.isShow,"onUpdate:modelValue":t[4]||(t[4]=u=>n.isShow=u),width:340,"close-on-click-modal":!1,title:n.title,"append-to-body":"",class:"show-footer-line"},{footer:m(()=>[p(_,{onClick:t[2]||(t[2]=u=>i.onCloseBtnClick())},{default:m(()=>[pi]),_:1}),p(_,{loading:n.isLoading,type:"primary",onClick:t[3]||(t[3]=u=>i.handleSubmit("teamForm"))},{default:m(()=>[fi]),_:1},8,["loading"])]),default:m(()=>[p(l,{ref:"teamForm",model:n.form,rules:n.rules,"label-position":"top",style:{"margin-bottom":"-19px"},onSubmit:t[1]||(t[1]=ce(u=>i.handleSubmit("teamForm"),["prevent"]))},{default:m(()=>[p(c,{label:"\u5206\u7EC4\u540D\u79F0",prop:"name",class:"hide_required"},{default:m(()=>[p(r,{type:"text",ref:"input",modelValue:n.form.name,"onUpdate:modelValue":t[0]||(t[0]=u=>n.form.name=u),placeholder:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",maxlength:255},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var mi=Z(hi,[["render",_i]]);const Xo=(e=Jt)=>({title:t,message:s,content:o,cb:n,onOk:i})=>(n=n||i,s=s||o,e({title:t,message:s,showCancelButton:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",beforeClose:function(r,c,l){r==="confirm"?(c.confirmButtonLoading=!0,Promise.resolve(n(l)).then(()=>l()).catch(_=>_).finally(()=>{c.confirmButtonLoading=!1})):l()}})),es=Xo();var gi={install:function(e){const t=e.config.globalProperties.$msgbox||Jt;e.config.globalProperties.$asyncMsgBox=Xo(t)}};function ts(e,t){function s(){mt(async()=>{if(e=v(e),!e)return;(await q(()=>import("./sortable.esm.85cd8ec3.js"),[])).default.create(e,D({animation:200,delay:400,delayOnTouchOnly:!0},t))})}return{initSortable:s}}const os=e=>(Qe("data-v-4f147e22"),e=e(),Xe(),e),vi={class:"flex flex-col bg-white border divide-y"},yi=os(()=>a("span",{class:"ml-1"},"\u6240\u6709\u9879\u76EE",-1)),Ai=["onClick"],Ei=["title"],Ci=os(()=>a("span",{class:"ml-1"},"\u6DFB\u52A0\u5206\u7EC4",-1)),ki=J("\u91CD\u547D\u540D "),Ii=J("\u5220\u9664 "),wi=ee({setup(e){const t=Qo(),{activeGroup:s,projectGroupList:o}=ne(t),n=b(null),i=b(!1),r=b(),c=b();let l=null;const _=k=>[{active:s.value.id===k}],f=()=>{var k;(k=n.value)==null||k.show()},u=k=>{t.switchProjectGroup(k)},y=(k,S)=>{l=S,r.value=k.currentTarget,i.value=!0},A=()=>{var k;l&&((k=n.value)==null||k.show(l))},h=()=>{l&&es({title:"\u5220\u9664\u63D0\u793A",content:`\u786E\u5B9A\u5220\u9664${l.name}\u5206\u7EC4\uFF1F`,onOk:()=>t.deleteProjectGroup(l).then(k=>{fe.success(k.msg||"\u5220\u9664\u6210\u529F\uFF01")})})};wo(r,k=>{var F,N;const P=k.target.parentNode,R=P.parentNode;((F=P==null?void 0:P.classList)==null?void 0:F.contains("el-icon__more"))||((N=R==null?void 0:R.classList)==null?void 0:N.contains("el-icon__more"))||(i.value=!1)});const{initSortable:C}=ts(c,{draggable:".ac-group-nav__item",onEnd(k){t.sortProjectGroup(k.oldIndex,k.newIndex)}});return et(async()=>{await t.getProjectGroupList(),C()}),bo(()=>{l=null}),(k,S)=>{const P=$e,R=qt;return d(),g(V,null,[p(oo,null,{default:m(()=>[a("div",vi,[a("a",{class:B(["relative flex items-center h-12 pl-6 text-neutral-600 hover:text-neutral-900",_(0)]),href:"javascript:void(0);",onClick:S[0]||(S[0]=F=>u())},[p(P,null,{default:m(()=>[p(v(rn))]),_:1}),yi],2),te(a("div",{class:"divide-y ac-group-nav",ref_key:"sortableList",ref:c},[(d(!0),g(V,null,ie(v(o),F=>(d(),g("a",{key:F.name,class:B(["relative flex items-center justify-between pr-4 text-neutral-600 hover:text-neutral-900 ac-group-nav__item",_(F.id)]),href:"javascript:void(0);"},[a("section",{class:"flex items-center flex-1 h-12 pl-6 overflow-hidden",onClick:N=>u(F)},[p(P,null,{default:m(()=>[p(v(an))]),_:1}),a("span",{class:"ml-1 truncate",title:F.name},M(F.name),9,Ei)],8,Ai),p(P,{onClick:N=>y(N,F),class:"ml-1 el-icon__more"},{default:m(()=>[p(v(xo))]),_:2},1032,["onClick"])],2))),128))],512),[[he,v(o).length]]),a("a",{class:"relative flex items-center h-12 pl-6 text-neutral-600 hover:text-neutral-900",href:"javascript:void(0);",onClick:f},[p(P,null,{default:m(()=>[p(v(cn))]),_:1}),Ci])])]),_:1}),p(mi,{ref_key:"addProjectCategoryModal",ref:n},null,512),p(R,{"popper-class":"ac-popper-menu",width:"auto",visible:i.value,"onUpdate:visible":S[1]||(S[1]=F=>i.value=F),"virtual-ref":r.value,"virtual-triggering":""},{default:m(()=>[a("ul",null,[a("li",{class:"ac-popper-menu__item",onClick:A},[p(P,{class:"mr-1"},{default:m(()=>[p(v(ln))]),_:1}),ki]),a("li",{class:"ac-popper-menu__item",onClick:h},[p(P,{class:"mr-1"},{default:m(()=>[p(v(dn))]),_:1}),Ii])])]),_:1},8,["visible","virtual-ref"])],64)}}});var bi=Z(wi,[["__scopeId","data-v-4f147e22"]]);const Ni=()=>q(()=>import("./Projects.76adf4d1.js"),["assets/Projects.76adf4d1.js","assets/Projects.93e1632d.css","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/ImagePreview.de54221d.js","assets/ImagePreview.e9afec23.css"]),Di={path:"",name:"projects.index",meta:{title:"\u9879\u76EE\u5217\u8868"},component:Ni},Pi=[Di],ss={path:it,name:"projects",meta:{title:"\u9879\u76EE",activeClassPrefixes:"project",browserTitle:"\u9879\u76EE - ApiCat"},redirect:{name:"projects.index"}};var Si=Y(D({},ss),{component:bi,children:Pi});const Bu=e=>E.get("/iterations",{params:e}),ji=e=>E.get("/iteration",{params:e}),$u=e=>E.post("/iteration/create",e),Fu=e=>E.post("/iteration/edit",e),Ku=e=>E.post("/iteration/remove",e),Ri=()=>E.get("/iteration/stars"),xi=e=>E.post("/iteration/star_order",e),Ti=e=>E.post("/iteration/star",e),Li=e=>E.post("/iteration/unstar",e),Uu=e=>E.post("/iteration/push",e),Vu=e=>ae(Ho)({iterate_id:e}),Oi=(e,t)=>ae(Jo)({iterate_id:e,node_id:t});ae(zo);const Ne=Be({id:"iterations",state:()=>({activeTab:void 0,collection:[],iterateInfo:null,isIterateRoute:!1}),getters:{isActiveIterateList:e=>e.activeTab===""},actions:{async getIterateInfo(e){if(this.iterateInfo&&this.iterateInfo.id_public===e)return this.iterateInfo;const{data:t}=await ji({iteration_id:e});return this.iterateInfo=t,this.iterateInfo},switchActiveCollectTab(e){const t=this.collection.find(s=>s.project_id===e);this.activeTab=t?e:""},async getIterateCollectionList(){try{const{data:e}=await Ri();this.collection=e||[],this.switchActiveCollectTab(this.collection.length?this.collection[0].project_id:"")}catch{}},async addProjectToCollect(e){const{project_id:t,project_title:s}=e;await Ti({project_id:t}),fe.success("\u6536\u85CF\u6210\u529F"),!this.collection.find(n=>n.project_id===t)&&this.collection.push({project_id:t,project_name:s})},async removeProjectFromCollect(e){const{project_id:t}=e;await Li({project_id:t}),fe.success("\u53D6\u6D88\u6536\u85CF\u6210\u529F"),this.collection=this.collection.filter(s=>s.project_id!==t)},async sortCollectionList(e,t){const s=this.collection.splice(e,1)[0];this.collection.splice(t,0,s),await xi({project_ids:this.collection.map(o=>o.project_id)})}}});const ns=e=>(Qe("data-v-615cfc29"),e=e(),Xe(),e),Mi={class:"flex flex-col border divide-y bg-white"},Bi=ns(()=>a("span",{class:"ml-1"},"\u8FED\u4EE3\u5217\u8868",-1)),$i=[Bi],Fi={class:"overflow-y-scroll mt-2 collection_list"},Ki=["onClick"],Ui={class:"overflow-hidden flex items-center flex-1 h-12 pl-6"},Vi=["title"],Gi={key:0,class:"relative flex pr-4 items-center justify-between text-neutral-600 hover:text-neutral-900"},Hi=ns(()=>a("section",{class:"overflow-hidden flex items-center flex-1 h-12 pl-6"},[a("span",{class:"ml-1",title:"ApiCat"},"\u6682\u65E0\u6536\u85CF")],-1)),Yi=[Hi],zi=ee({setup(e){const t=b(),s=Ne(),{activeTab:o,collection:n}=ne(s),[i,r]=qo(s.getIterateCollectionList),c=f=>[{active:o.value===f.project_id}],l=f=>{s.switchActiveCollectTab(f.project_id)},{initSortable:_}=ts(t,{draggable:".collection_item",onEnd(f){const{oldIndex:u,newIndex:y}=f;s.sortCollectionList(u,y)}});return et(async()=>{await r(),_()}),bo(()=>{s.$patch({activeTab:void 0})}),(f,u)=>{const y=nt;return d(),$(oo,null,{default:m(()=>[a("div",Mi,[a("a",{class:B(["relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900",c({project_id:""})]),href:"javascript:void(0);",onClick:u[0]||(u[0]=A=>l({}))},$i,2)]),te((d(),g("div",Fi,[a("div",{class:"flex flex-col border divide-y bg-white",ref_key:"sortableEle",ref:t},[(d(!0),g(V,null,ie(v(n),A=>(d(),g("a",{key:A.project_id,class:B(["relative flex pr-4 items-center justify-between text-neutral-600 hover:text-neutral-900 collection_item",c(A)]),href:"javascript:void(0);",onClick:h=>l(A)},[a("section",Ui,[a("span",{class:"ml-1 truncate",title:A.project_name},M(A.project_name),9,Vi)])],10,Ki))),128)),v(n).length?T("",!0):(d(),g("a",Gi,Yi))],512)])),[[y,v(i)]])]),_:1})}}});var Ji=Z(zi,[["__scopeId","data-v-615cfc29"]]);const qi=()=>q(()=>import("./IterateListContainer.8579fdb1.js"),["assets/IterateListContainer.8579fdb1.js","assets/IterateListContainer.6f16337e.css","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/useTable.87e4fb80.js","assets/usePage.11ff97df.js"]),Wi={path:"",name:"iterations.index",meta:{title:"\u8FED\u4EE3"},component:qi},Zi=[Wi],is={path:"/iterations",name:"iterations",meta:{title:"\u8FED\u4EE3",activeClassPrefixes:"iterations",browserTitle:"\u8FED\u4EE3 - ApiCat"},redirect:{name:"iterations.index"}};var Qi=Y(D({},is),{component:Ji,children:Zi});const Xi=()=>q(()=>import("./MemberList.b61188b1.js"),["assets/MemberList.b61188b1.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/usePage.11ff97df.js"]),rs={path:"/members",name:"members",meta:{title:"\u6210\u5458"}};var er=Y(D({},rs),{component:Xi});const tr={class:"h-14"},or={class:"fixed top-0 z-50 w-full bg-white shadow"},sr={class:"relative flex items-center justify-between viewport h-14"},nr={class:"flex items-center flex-1"},ir=a("img",{class:"w-auto h-10",src:rt,alt:"ApiCat"},null,-1),rr=a("span",{class:"logo-text logo-apicat"},"ApiCat",-1),ar={class:"ml-6"},cr=["onClick"],lr={class:"flex items-center"},dr={class:"relative ml-3"},ur={class:"el-dropdown-link"},hr={type:"button",class:"flex items-center rounded-full","aria-expanded":"false","aria-haspopup":"true"},pr=["src"],fr={key:1},_r={class:"flex flex-col justify-center text-sm divide-y"},mr={class:"px-6 py-2"},gr=["title"],vr=["title"],yr={class:"ml-1"},Ar=a("i",{class:"iconfont iconIconPopoverExit"},null,-1),Er=a("span",{class:"ml-1"},"\u9000\u51FA\u767B\u5F55",-1),Cr=[Ar,Er],kr={class:"px-8 py-4 viewport"},Ir=ee({setup(e){const t={modifiers:[{name:"offset",options:{offset:[-24,10]}}]},s=b([{name:"user.profile",title:"\u4E2A\u4EBA\u4FE1\u606F",icon:"iconIconPopoverUser"}]),o=[ss,is,rs],n=we(),{currentRoute:i}=tt(),{userInfo:r,lastName:c}=ne(n),l=async()=>{await n.logout()},_=f=>{const u=(i.value.name||"").startsWith(f.meta.activeClassPrefixes||f.name);return["px-3 cursor-pointer",{"text-blue-600":u}]};return et(async()=>{await n.getUserInfo()}),(f,u)=>{const y=X("router-link"),A=un,h=$e,C=hn,k=pn,S=X("router-view");return d(),g(V,null,[a("header",tr,[a("div",or,[a("div",sr,[a("div",nr,[p(y,{class:"inline-flex items-center",to:v(it)},{default:m(()=>[ir,rr]),_:1},8,["to"]),a("div",ar,[(d(),g(V,null,ie(o,P=>p(y,{to:{name:P.name},key:P.name,custom:""},{default:m(({navigate:R})=>[a("span",{class:B(_(P)),onClick:R},M(P.meta.title),11,cr)]),_:2},1032,["to"])),64))])]),a("div",lr,[a("div",dr,[p(k,{placement:"bottom-end",trigger:"click","popper-class":"nav-dropdown","popper-options":t},{dropdown:m(()=>[p(C,null,{default:m(()=>[a("div",_r,[a("div",mr,[a("p",{class:"text-base font-bold text-gray-600 truncate",title:v(r).name},M(v(r).name),9,gr),a("p",{class:"text-gray-500 truncate",title:v(r).email},M(v(r).email),9,vr)]),(d(!0),g(V,null,ie(s.value,P=>(d(),$(y,{key:P.name,class:"flex items-center px-6 py-3 hover:text-gray-700",to:{name:P.name}},{default:m(()=>[a("i",{class:B("iconfont "+P.icon)},null,2),a("span",yr,M(P.title),1)]),_:2},1032,["to"]))),128)),a("a",{class:"flex items-center px-6 py-3 hover:text-gray-700",href:"javascript:void(0)",onClick:l},Cr)])]),_:1})]),default:m(()=>[a("span",ur,[a("button",hr,[p(A,null,{default:m(()=>[v(r).avatar?(d(),g("img",{key:0,src:v(r).avatar},null,8,pr)):(d(),g("span",fr,M(v(c)),1))]),_:1}),p(h,{class:"el-icon--right"},{default:m(()=>[p(v(fn))]),_:1})])])]),_:1})])])])])]),a("main",kr,[p(S)])],64)}}});const ve=e=>(Qe("data-v-47f509cc"),e=e(),Xe(),e),wr={class:"h-14"},br={class:"shadow bg-white fixed top-0 w-full z-50"},Nr={class:"viewport relative items-center justify-between h-14 lg:flex hidden"},Dr={class:"flex-1 flex items-center"},Pr=ve(()=>a("div",{class:"flex-shrink-0 flex"},[a("a",{class:"inline-flex items-center",href:"/"},[a("img",{class:"h-10 w-auto",src:rt,alt:"ApiCat"}),a("span",{class:"logo-text logo-apicat"},"ApiCat")])],-1)),Sr={key:0,class:"ml-6 hidden lg:block"},jr=ve(()=>a("div",{class:"flex text-gray-600"},[a("a",{href:"https://apicat.net",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u9996\u9875"),a("a",{href:"https://apicat.net/app/31eb8ec8c295c8c4130ee50304d55ab5",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u6587\u6863"),a("a",{href:"https://github.com/NatosoftCN/ApiCat_Open",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"Github")],-1)),Rr=[jr],xr={key:0},Tr=J("\u767B\u5F55"),Lr=J("\u6CE8\u518C"),Or={class:"lg:hidden"},Mr={class:"flex items-center justify-between h-14 px-4 relative"},Br=ve(()=>a("img",{class:"h-10 w-auto",src:rt,alt:"ApiCat"},null,-1)),$r=ve(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),Fr=ve(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M21 7H3V5H21V7Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 13H3V11H21V13Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 19H3V17H21V19Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),Kr=[Fr],Ur={key:0,class:"bg-white fixed top-0 left-0 w-full max-h-screen flex flex-col z-10"},Vr={class:"flex items-center justify-between h-14 px-4"},Gr=ve(()=>a("img",{class:"h-10 w-auto",src:rt,alt:"ApiCat"},null,-1)),Hr=ve(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),Yr=ve(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M12.0001 13.4141L17.6568 19.0708L19.0711 17.6566L13.4143 11.9998L19.0711 6.34304L17.6569 4.92883L12.0001 10.5856L6.34314 4.92871L4.92893 6.34292L10.5859 11.9998L4.92896 17.6567L6.34317 19.071L12.0001 13.4141Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),zr=[Yr],Jr={class:"flex-1 overflow-y-auto"},qr=ve(()=>a("div",{class:"px-4 text-base font-medium"},[a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"/"},"\u9996\u9875"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"\u6587\u6863"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"GitHub")],-1)),Wr={class:"px-5"},Zr=J("\u767B\u5F55"),Qr=J("\u6CE8\u518C"),Xr=ee({props:{isShowNav:{type:Boolean,default:!0}},setup(e){const t=b(!1);return pe(t,()=>{document.body.classList.toggle("overflow-hidden")}),(s,o)=>{const n=st,i=X("router-link");return d(),g("header",wr,[a("div",br,[a("div",Nr,[a("div",Dr,[Pr,e.isShowNav?(d(),g("div",Sr,Rr)):T("",!0)]),e.isShowNav?(d(),g("div",xr,[p(i,{to:v(We),class:"mr-4"},{default:m(()=>[p(n,null,{default:m(()=>[Tr]),_:1})]),_:1},8,["to"]),p(i,{to:v(Zt)},{default:m(()=>[p(n,{type:"primary"},{default:m(()=>[Lr]),_:1})]),_:1},8,["to"])])):T("",!0)]),a("div",Or,[a("div",Mr,[p(i,{class:"inline-flex items-center",to:"/"},{default:m(()=>[Br,$r]),_:1}),a("div",{class:"cursor-pointer",onClick:o[0]||(o[0]=r=>t.value=!t.value)},Kr),p(Os,{name:"slide-fade"},{default:m(()=>[t.value?(d(),g("div",Ur,[a("div",Vr,[p(i,{class:"inline-flex items-center",to:"/"},{default:m(()=>[Gr,Hr]),_:1}),a("div",{class:"cursor-pointer",onClick:o[1]||(o[1]=r=>t.value=!t.value)},zr)]),a("div",Jr,[qr,a("div",Wr,[p(i,{to:"/login"},{default:m(()=>[p(n,{class:"w-full"},{default:m(()=>[Zr]),_:1})]),_:1}),p(i,{to:"/"},{default:m(()=>[p(n,{type:"primary",class:"w-full my-5"},{default:m(()=>[Qr]),_:1})]),_:1})])])])):T("",!0)]),_:1}),t.value?(d(),g("div",{key:0,class:"fixed top-0 left-0 w-screen h-screen bg-opacity-40 bg-gray-900",onClick:o[2]||(o[2]=r=>t.value=!t.value)})):T("",!0)])])])])}}});var ea=Z(Xr,[["__scopeId","data-v-47f509cc"]]);const as=ee({setup(e){const t=b(!0);return ue("switchNavState",o=>{t.value=o}),(o,n)=>{const i=X("router-view");return d(),g(V,null,[p(ea,{"is-show-nav":t.value},null,8,["is-show-nav"]),p(i)],64)}}}),ta=()=>q(()=>import("./Index.90d12e01.js"),["assets/Index.90d12e01.js","assets/Index.46d30f47.css","assets/vendor.4578470d.js"]),oa=()=>q(()=>import("./Login.6b486abd.js"),["assets/Login.6b486abd.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js"]),sa=()=>q(()=>import("./Register.bb76beb0.js"),["assets/Register.bb76beb0.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js"]),na=()=>q(()=>import("./NotFound.73003636.js"),["assets/NotFound.73003636.js","assets/NotFound.3339f423.css","assets/vendor.4578470d.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css"]),ia={path:Bo,name:"index",component:as,meta:{ignoreAuth:!0},children:[{path:"",name:"index.feature",component:ta}]},ra={path:We,name:"login",meta:{ignoreAuth:!0},component:oa},aa={path:Zt,name:"register",meta:{ignoreAuth:!0},component:sa},ca={path:"/:path(.*)*",name:"error",component:as,meta:{ignoreAuth:!0},children:[{path:"/:path(.*)*",name:"error.not.found",component:na}]},la=ee({setup(e){const t=b(cs);return(s,o)=>(d(),$(oo,{menus:t.value},null,8,["menus"]))}}),da=()=>q(()=>import("./UserProfile.0123e75f.js"),["assets/UserProfile.0123e75f.js","assets/ImagePreview.de54221d.js","assets/ImagePreview.e9afec23.css","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js"]),ua=()=>q(()=>import("./ModifyPassword.037c9b3d.js"),["assets/ModifyPassword.037c9b3d.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js"]),cs=[{path:"profile",name:"user.profile",meta:{title:"\u4E2A\u4EBA\u4FE1\u606F"},component:da},{path:"password",name:"user.password",meta:{title:"\u4FEE\u6539\u5BC6\u7801"},component:ua}];var ha={path:"/user",name:"user",redirect:{name:"user.profile"},component:la,children:cs};const pa=()=>q(()=>import("./ProjectNav.7f463644.js"),["assets/ProjectNav.7f463644.js","assets/vendor.4578470d.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css"]),fa=()=>q(()=>import("./ProjectSetting.d0c3217d.js"),["assets/ProjectSetting.d0c3217d.js","assets/ImagePreview.de54221d.js","assets/ImagePreview.e9afec23.css","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js"]),_a=()=>q(()=>import("./ProjectMembers.c7fac2d4.js"),["assets/ProjectMembers.c7fac2d4.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/useTable.87e4fb80.js","assets/usePage.11ff97df.js"]),ma=()=>q(()=>import("./ProjectParam.908cc192.js"),["assets/ProjectParam.908cc192.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/params.cc02e58f.js"]),ga=()=>q(()=>import("./ProjectTrash.39b814ba.js"),["assets/ProjectTrash.39b814ba.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js"]),ls=[{path:Fo,name:"project.setting",component:fa,meta:{title:"\u9879\u76EE\u8BBE\u7F6E",role:[z.MANAGER]}},{path:Ko,name:"project.members",component:_a,meta:{title:"\u9879\u76EE\u6210\u5458",role:[z.MANAGER,z.DEVELOPER,z.READER]}},{path:Uo,name:"project.params",component:ma,meta:{title:"\u516C\u5171\u53C2\u6570",role:[z.MANAGER,z.DEVELOPER]}},{path:Vo,name:"project.trash",component:ga,meta:{title:"\u56DE\u6536\u7AD9",role:[z.MANAGER,z.DEVELOPER]}}],Eo=Ms(ls);var va={path:"/project/:project_id",name:"project",component:pa,children:ls};const ya={data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u51FA\u9879\u76EE",params:{},exportList:[],jobParams:{id:null},currentConfig:null,timer:null}},watch:{isShow:function(){this.isShow||(this.clearTimer(),this.isLoading=!1)}},methods:{hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.exportList=t||[],this.params=e||{}},onItemClick(e){this.currentConfig=e||null,this.getImportJobId(this.buildParams(e))},getImportJobId(e){if(this.jobParams.id=null,!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult)return this.clearTimer(),Promise.resolve();this.isLoading=!0;try{const{data:e}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);let t=e.description||"";if(e.result===Ue.FAIL&&this.isShow){this.isLoading=!1,this.$Message.error(t||"\u5BFC\u51FA\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===Ue.WAIT&&this.isShow)return;e.result===Ue.FINISH&&this.isShow&&(this.$Message.success(t||"\u5BFC\u51FA\u5B8C\u6210\uFF01"),this.isLoading=!1,this.clearTimer(),this.hide(),e.url&&Bs(e.url))}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(this.params),await No(2e3)},buildParams(e){return this.params.type=e.type,this.params}},unmounted(){this.clearTimer()}},Aa={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},Ea=["onClick"],Ca=["src","alt"],ka={class:"mt-1.5"};function Ia(e,t,s,o,n,i){const r=ot,c=nt;return d(),$(r,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content","close-on-click-modal":!1,"append-to-body":"",title:n.title},{default:m(()=>[te((d(),g("div",Aa,[(d(!0),g(V,null,ie(n.exportList,l=>(d(),g("div",{class:"ac-project-export-item",key:l.type},[a("div",{class:"ac-project-export-inner",onClick:_=>i.onItemClick(l)},[a("img",{src:l.icon,alt:l.text},null,8,Ca),a("p",ka,M(l.text),1)],8,Ea)]))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var wa=Z(ya,[["render",Ia],["__scopeId","data-v-159cc67b"]]),ds="/assets/logo-apicat@2x.ca5d403d.png",ba="/assets/logo-markdown@2x.084fed6d.png",us="/assets/logo-postman@2x.3bda39f9.png";const Gu=e=>E.get("/api_url/list",{params:{project_id:e}}),Hu=(e,t)=>E.post("/api_url/remove",{project_id:e,url_id:t}),Yu=(e,t="json")=>{const{project_id:s,doc_id:o}=e||{},n=j.get(j.KEYS.SECRET_PROJECT_TOKEN+s||"",!0);return E.get("/api_doc",{params:{project_id:s,doc_id:o,format:t,token:n}})},Na=(e,t)=>{const s=j.get(j.KEYS.SECRET_PROJECT_TOKEN+e.project_id||"",!0);return E.get("/api_doc/search",{params:Y(D({},e||{}),{keywords:t,token:s})})},Da=(e={})=>E.post("/api_doc/create",D({},e)),Pa=(e={})=>E.post("/api_doc/http_template",D({},e)),zu=(e={})=>(typeof e.content=="object"&&(e.content=JSON.stringify(e.content)),E.post("/api_doc/update",e)),Sa=(e={})=>E.post("/api_doc/copy",e),ja=(e={})=>E.post("/api_doc/rename",e),Ra=(e={})=>E.post("/api_doc/remove",e),xa=(e={})=>E.post("/api_doc/share",D({},e)),Ta=(e={})=>E.post("/api_doc/share_detail",D({},e)),La=(e={})=>E.post("/api_doc/share_secretkey",D({},e)),Nt=e=>E.post("/api_doc/import",e),Dt=(e,t)=>E.get("/api_doc/import_result",{params:{project_id:e,job_id:t}}),Oa=[{text:"ApiCat",icon:ds,type:"apicat",action:Nt,getJobResult:Dt,maxSize:2,accept:".json"},{text:"Markdown",icon:ba,type:"markdown",action:Nt,getJobResult:Dt,maxSize:.5,accept:".md"},{text:"Postman(v2.1)",icon:us,type:"postman",action:Nt,getJobResult:Dt,maxSize:2,accept:".json"}],hs=(e,t)=>ae(to)({project_id_public:e,node_id:t}),Ma=(e,t,s)=>Fe(s)+hs(e,t),re=Be({id:"project",state:()=>({projectInfo:null,projectAuthInfo:{}}),getters:{isManager:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===z.MANAGER,isDeveloper:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===z.DEVELOPER,isReader:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===z.READER,isGuest:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===z.NONE,isPrivate:e=>e.projectAuthInfo&&e.projectAuthInfo.visibility===Ce.PRIVATE},actions:{async getProjectDetail(e){var o;const t=j.get(j.KEYS.SECRET_PROJECT_TOKEN+e||"",!0),{data:s}=await ii(e,t);return this.projectInfo=Y(D({},s||{}),{visible:(o=wt.find(n=>n.key===s.visibility))==null?void 0:o.value}),this.projectInfo},async getProjectDetailById(e={project_id:null,iteration_id:null}){var s;const{data:t}=await ri(e);return this.projectInfo=Y(D({},t||{}),{visible:(s=wt.find(o=>o.key===t.visibility))==null?void 0:s.value}),this.projectInfo},async getProjectAuth(e){const{data:t}=await ai(e);return this.projectAuthInfo=t||{},this.projectAuthInfo.id=e,this.projectAuthInfo.in_this=this.projectAuthInfo.authority!==z.NONE,this.projectAuthInfo},async updateProjectInfo(e){var s;const t=await Zn(e);return this.projectInfo=Y(D(D({},this.projectInfo),e),{visibility:(s=wt.find(o=>o.value===e.visible))==null?void 0:s.key}),this.projectAuthInfo.visibility=this.projectInfo.visibility,t},clearProjectInfo(){this.projectInfo=null}}}),Ju=e=>E.post("/api_doc/secretkey_check",e),Ba=e=>E.get("/api_doc/has_shared",{params:{doc_id:e}}),$a=(e,t)=>E.get("/api_doc",{params:{doc_id:e,token:t,format:"html"}}),qu=(e,t)=>E.get("/api_doc",{params:{project_id:e,doc_id:t,deleted:1,format:"html"}}),Fa=e=>E.get("/preview/project",{params:{project_id:e}}),Wu=e=>E.post("/project/secretkey_check",e),Ka=(e,t,s)=>E.get("/preview/search",{params:{project_id:t,keywords:s,token:e}}),Co=(e,t)=>Fe(t)+ae(Rn)({doc_id:e}),Ua={watch:{shareData(){this.shareData.docId!==-1&&this.getShareDetail()}},setup(){const e=re(),{projectInfo:t}=ne(e),s=Kt({projectInfo:t,document:null,isShow:!1,isShowDetail:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:b(),shareData:{docId:-1}});return D({},Ut(s))},methods:{onShareStatusSwitch(e){this.document!==null&&(this.isLoading=!0,xa({project_id:this.projectInfo.id,doc_id:this.shareData.docId,share:e}).then(({data:t})=>{e?(this.updateLinkAndPassword(Co(this.shareData.docId),t.secret_key),this.document.secret_key=t.secret_key):(this.document.secret_key="",this.isShare=!1)}).catch(t=>{console.log(t),this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.document.visibility===bt.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(e){this.shareData=e||{docId:-1},this.isShow=!0},setDocument(e={}){this.document=e;const t=e.visibility===bt.PUBLIC;return this.copyText=t?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",this.isShare=!t&&!!e.secret_key,e.link=t?Ma(this.projectInfo.id_public,this.shareData.docId):this.isShare?Co(this.shareData.docId):"",this.updateLinkAndPassword(e.link,e.secret_key),this},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,La({project_id:this.projectInfo.id,doc_id:this.shareData.docId}).then(({data:e})=>this.updateLinkAndPassword(null,e)).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){this.copyTextEl.value=this.document.visibility===bt.PUBLIC?this.shareUrl:[`\u94FE\u63A5\uFF1A${this.shareUrl}`,`\u5BC6\u7801\uFF1A${this.password}`].join(`
`)},getShareDetail(){this.isShowDetail=!0,Ta({project_id:this.projectInfo.id,doc_id:this.shareData.docId}).then(({data:e})=>{this.setDocument(e)}).finally(()=>{this.isShowDetail=!1})}}},Va={class:"-m-4"},Ga={key:0},Ha={key:1},Ya=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),za=J("\u91CD\u7F6E\u5BC6\u7801"),Ja={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function qa(e,t,s,o,n,i){const r=st,c=yt,l=Yt,_=zt,f=To,u=Lo,y=ot,A=nt;return d(),$(y,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=h=>e.isShow=h),title:"\u5206\u4EAB\u6587\u6863",class:"vertical-center-modal",width:540,"append-to-body":""},{default:m(()=>[te((d(),g("div",Va,[e.document&&e.document.visibility===1?(d(),g("div",Ga,[p(_,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[p(l,{label:""},{default:m(()=>[p(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=h=>e.shareUrl=h)},{append:m(()=>[p(r,{type:"primary",onClick:i.copy},{default:m(()=>[J(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):T("",!0),e.document&&e.document.visibility===0?(d(),g("div",Ha,[a("div",{class:B(["flex items-center px-6",{"py-3":!e.isShare,"pt-3":e.isShare}])},[Ya,p(f,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=h=>e.isShare=h),onChange:i.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(d(),$(u,{key:0})):T("",!0),e.isShare?(d(),$(_,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[p(l,{label:"\u6587\u6863\u94FE\u63A5"},{default:m(()=>[p(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=h=>e.shareUrl=h)},{append:m(()=>[p(r,{type:"primary",onClick:i.copy},{default:m(()=>[J(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),p(l,{label:"\u5BC6\u7801"},{default:m(()=>[p(l,{prop:"date",class:"mr-1"},{default:m(()=>[p(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=h=>e.password=h)},null,8,["modelValue"])]),_:1}),p(r,{loading:e.isLoadingResetPwd,onClick:i.onResetPasswordBtnClick},{default:m(()=>[za]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):T("",!0)])):T("",!0)])),[[A,e.isShowDetail]]),a("textarea",Ja,null,512)]),_:1},8,["modelValue"])}var Wa=Z(Ua,[["render",qa]]);const Za={setup(){const e=Kt({project:null,dom:null,isShow:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:b()});return D({PROJECT_VISIBLE_TYPES:Ce},Ut(e))},methods:{onShareStatusSwitch(e){this.project!==null&&(this.isLoading=!0,Qn(this.project.id,Number(e)).then(({msg:t,data:s})=>{s=s||{},this.$Message.success(t||"\u64CD\u4F5C\u6210\u529F"),this.updateLinkAndPassword(yo(this.project.id),s.secret_key),e?this.project.secret_key=s.secret_key:delete this.project.secret_key}).catch(t=>{this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.project.visibility===Ce.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(e={}){this.isShow=!0,this.project=e,this.copyText=e.visibility===Ce.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",e.visibility===Ce.PRIVATE&&e.secret_key?this.isShare=!0:this.isShare=!1,this.updateLinkAndPassword(yo(e.id),e.secret_key)},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,Xn(this.project.id).then(({data:e})=>{this.project.secret_key=e,this.updateLinkAndPassword(null,e)}).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){var e=[this.project.name?`\u300A${this.project.name}\u300B`:"",`\u94FE\u63A5\uFF1A${this.shareUrl}`];this.project.visibility!==Ce.PUBLIC&&e.push(`\u5BC6\u7801\uFF1A${this.password}`),this.$nextTick(()=>{this.copyTextEl.value=e.join(`
`)})}}},Qa={key:0,class:"-m-4"},Xa={key:1,class:"-m-4"},ec=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),tc=J("\u91CD\u7F6E\u5BC6\u7801"),oc={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function sc(e,t,s,o,n,i){const r=st,c=yt,l=Yt,_=zt,f=To,u=Lo,y=ot;return d(),$(y,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=A=>e.isShow=A),width:540,"close-on-click-modal":!1,title:"\u5206\u4EAB\u9879\u76EE","append-to-body":""},{default:m(()=>[e.project&&e.project.visibility===o.PROJECT_VISIBLE_TYPES.PUBLIC?(d(),g("div",Qa,[p(_,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[p(l,{label:""},{default:m(()=>[p(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=A=>e.shareUrl=A)},{append:m(()=>[p(r,{type:"primary",onClick:i.copy},{default:m(()=>[J(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):T("",!0),e.project&&e.project.visibility===o.PROJECT_VISIBLE_TYPES.PRIVATE?(d(),g("div",Xa,[a("div",{class:B(["px-6 flex items-center",{"py-3":!e.isShare,"pt-3":e.isShare}])},[ec,p(f,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=A=>e.isShare=A),onChange:i.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(d(),$(u,{key:0})):T("",!0),e.isShare?(d(),$(_,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[p(l,{label:"\u9879\u76EE\u94FE\u63A5"},{default:m(()=>[p(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=A=>e.shareUrl=A)},{append:m(()=>[p(r,{type:"primary",onClick:i.copy},{default:m(()=>[J(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),p(l,{label:"\u5BC6\u7801"},{default:m(()=>[p(l,{prop:"date",class:"mr-1"},{default:m(()=>[p(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=A=>e.password=A)},null,8,["modelValue"])]),_:1}),p(r,{loading:e.isLoadingResetPwd,onClick:i.onResetPasswordBtnClick},{default:m(()=>[tc]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):T("",!0)])):T("",!0),a("textarea",oc,null,512)]),_:1},8,["modelValue"])}var nc=Z(Za,[["render",sc]]),ic="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAJiElEQVR4Xu2de4xU5RnGn+/Msgu7zMzusgGJlUiCCZcELbFJi7GJtrShtgs21RJMi4tim0aqmF5iayMtsTQkbbdYtNTSKtYorpWGmOItqESwaKDEFhURpFsKre7szsyZ3dlhZ87bnDNd3MvMzvnO9ZvZ9/zH8j7v937P8+NcdoYZARcHEcWSur4OhBUA5gNoIyLhomXVSJ996eDjq69fvrpqBi4zqOOwkkn9RhL0ABHNqHYTnMz/SNczmNXWWvUQOAKgL5W6gwidToyrFY0JgHlUOwTSAPTp+jUw6EUi0molTCf7GAag2iGQAsC8vidT+lECLXZiWi1pRgJQzRBIAZBOp5fmDTpQS0E63ctYAKoVAikA+lKpjUS416lptaQrBUA1QiAHQDK9g0BraylIp3spB0C1QSALwJMEusGpabWkmwiAaoKAAXBIZSUAqgUCBsBHAKoBAgbAZwBUh4ABCAAAlSFgAAICQFUIGIAAAVARAgYgYABUg4ABCAEAlSBgAEICQBUIGIAQAVABAgYgZADChoABUACAMCFgABQBICwIGACFAAgDAgZAMQCChoABcAjAY7ufRT6fd6iuLAvq3cYMQOUsSlb8+blXkErrDtX2ZEFAwADYy2Jc1etHj+HtE+87VNuX+Q0BA2A/i1GVybSOPc/vBxE57GBf5icEDID9HMZVHjryd7xz8p8uOtiX+gUBA2A/g3GVhmHghf2H8J8PEy662Jf6AQEDYN//kpUmBG8cPYbjp7qr8nLAALgEYFhu3hO8e6obZ//bg/6BbNU8IjIAHgEwtk2mP4v+7KBP3YEF8y6Vyq7cIFJN+pJp/o8hEpH6CQEDIBFEmKV+QcAAhJmq5Np+QMAASIYQdrnXEDAAYSfqYH0vIWAAHASggsQrCBgAFdJ0OIMXEDAADs1XReYWAgZAlSRdzOEGAgbAhfEqSZ1CwAColKLLWZxAwAC4NF01uSwEDIBqCXowjwwEDIAHhqvYwi4EDICK6Xk0kx0IGACPzFa1TSUIGABVk/NwrokgYAA8NFrlVuUgYABUTs3j2UpBwAB4bLLq7cZCwAConpgP842EgAHwweBqaDkMAQNQDWn5NKMJwZyLL5J6R3e5UaSa8NvCfUrUQdvW5rhUdgyAA5NVljAAKqcTwGwMQAAmq7wEA6ByOgHMxgAEYLLKSzAAKqcTwGwMQAAmq7yE5wAkOlZ83iD6IYiWAGhSefNVOVusGWLeQogVqyCaW11vwVMAejra15BBD7ueihtUdqBxOrTv/9Q1BJ4BQLfd1pjInTtHQKzy9FzhhQNiyVJoa77lqpVnAPSuab+qAHrV1TQslnMg1ozIpl/LacZUewZA4ub2GwyiJ11Nw2JpByK/+qO0ZqSAAXBlX/hiBiD8DEKdgAEI1f7wF2cAws8g1AkYgFDtD39xBiD8DEKdgAEI1f7wF2cAws8g1AkYgFDtD3/xmgWg/spPYerVy0o6TNkBFBIfoHD2DHKH9gNjvnUruv5uiLopo7VEKPQlUDh3BoWz/0L+vXdAg9mS/UvqS1Tmz5zGQNfOUCmoWQCmLb8eTV/tqGhuobcHmR1bMXTs6IXaGdu7IBoaJtRauoe3YejNw+Pq7OhN0dDxfyC1+QcVZ/SzYFIAMLB3N8x/9dYhAK1xOiJz5qJ+wWLrR0ZGR/Ke9TCSvdafhwPMnz6J3JG/FmX19Yi0zYQ2czbq5l4GIYpvhzd7D+z6w6iMSulLhWj0fIDcwZf8zLdi70kBQO9da2H09owzo+GqaxFdd6f18/6nHkX2ma5RAAzufwGZ398/TmcC0PT1b2LK3Musr2dJ/eQ7yL9/YtwZpJy+YioBFkxqAEyfWx98Atq0Rgy+9goy239uCwDrjBCNo2XLdks7dOpdC4LhY/gMwADYJ1l4/XLwyHuAcmcANEzFjK07IRqmInf4Nej3b7YNgFnYuHI1GleusjSJ228CZYrf4MkA2A9+uDIUABqu/iyit3y7eC3fswsDTz8mFWD9FZ9A7M4fWZrkpu8if/L4KH3ujYPof6r8Xb7RlwDO5+Td8lAxKS4B6a33wUinLtgmmqKou+RSTFv2RWjxFlChgJQZ4On3pACIXDwHLfcV31Gj//aXF27o7D4FpH7x45JPER7mW7HVpABgIhfMm7iBrkeQ/cvT0tdw84mgdct2S2c+Eg6+/NwogCq5zwB85JCvlwDKDwEjvlqXsv0o9HyIwtluZPfuRuHf3aOysnsNn7LwcsS/t8nSprbcg6G33hx9BjmwD5mdvynPwfnzABmVOPH17yfFGaDsTWAZa+0CMPUz12H6175hdRm5hl29r8nabM4AlDDKVoCROrRs3obIzNnWL5B6N3QA//8Gb1t6mwH5XcYAOAGgvh5Nq9Zi2rVfKN4APtSJ3IF90vcQfodrpz8DMAEA5q+Bs3t2FSummL8KnoXIrNlo+PQyRFrbrB8PnTxuPUGMPPgMYAe90TW+3gQ6vQeYaBvm08Pgvr3WE8TYVwUZgBoFwHwF0Hwp2HxJOPf6q8ifeLvkThkABQCQH2FyKmr2HmByxim/awZA3rOaUjAANRWn/GYYAHnPakrBANRUnPKbYQDkPaspBQNQU3HKb0YZAHpubv8yEf1JfguscOyAEIh0PupYbgq9+4SQjhULDcM45moaFks5IC76GLS7fyalGVvsGQC0caPWc/rIYRBd4WoiFtt2QLvuKxCfW2m7vlShZwCYzRPrvrSIhsReIrrE1VQsruzAoo8jcusGQNMq105Q4SkAFgTrb4qRnl4DaEsAKvlJoWLe/E/S9BhD4iQ665NCF0AsvtKJepzGcwDsTMVfGWPHpWBqGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBwgJgB4HWBrNFXmUCBzKtzfGoFw4VP3XR5tGX0u8lMjbaLOcyvxwQ4q3WeGyRF+2lAEin00vzBh3wYmHu4dwBIbTOlnh0g/MOHymlACAiLZnS/0ag4me98hG4A0IIo04Ti6PRqCfv45QCwNxtn65fA4NeNGEIfPe8IITAtpZ4/HavrJAGwIIglbqDCJ1eDcF97DkgIPY1x6PLhRDn7SkqVzkCwGybTOo3kqAHiGhG5WW4wo0D5mkfoAebY7G7vAzfnMkxAKa4lyiu6fo6IrQDmA+gjYhc9XRjVI1pMxCiW0A8X6fhd15d88d69D+MM3rbPGNofwAAAABJRU5ErkJggg==";const Pt=(e={})=>E.post("/api_doc/export",e),St=(e,t)=>E.get("/api_doc/export_result",{params:{project_id:e,job_id:t}}),ps=[{text:"ApiCat",icon:ds,type:"apicat",action:Pt,getJobResult:St},{text:"PDF",icon:ic,type:"pdf",action:Pt,getJobResult:St},{text:"Postman(v2.1)",icon:us,type:"postman",action:Pt,getJobResult:St}],fs=ps,_s=()=>{const{projectInfo:e}=re(),{iterateInfo:t,isIterateRoute:s}=Ne(),o={isIterateRoute:s};return o.projectId=e.id,o.projectPublicId=e.id,s&&(o.iterationPublicId=t.id,o.iterationId=t.id),o},ms=()=>{const{isIterateRoute:e}=Ne(),{params:t}=Vt();return t[e?"iterate_id":"project_id"]},Ee=e=>{const t={};return e.projectId&&(t.project_id=e.projectId),e.iterationId&&(t.iteration_id=e.iterationId),t},rc={class:"ac-project-info ac-project-info--hover"},ac={key:0,class:"ac-project-info__img"},cc=["src","alt"],lc=["href"],dc={class:"ac-project-info__img"},uc=["src","alt"],hc=["href"],pc=["onClick"],fc={key:1,class:"ac-project-info__img"},_c=["src","alt"],mc=["href"],gc={class:"pr-2 overflow-hidden"},vc=["title"],yc=["title"],Ac=["title"],Ec=ee({setup(e){const t=re(),s=Ne(),{isIterateRoute:o,iterateInfo:n}=ne(s),{projectInfo:i,isManager:r,isPrivate:c,isDeveloper:l}=ne(t),_=b(),f=ge("projectExportModal"),u=ms(),y=S=>{if(S.hrefFn){location.href=S.hrefFn(u,!1);return}},A=()=>{var S;f.value.title="\u5BFC\u51FA\u9879\u76EE",(S=f.value)==null||S.show({project_id:i.value.id},ps)},h=()=>{var S;(S=_.value)==null||S.show(i.value)},C=[{text:"\u9879\u76EE\u8BBE\u7F6E",icon:"iconIconPopoverSetting",hrefFn:ci},{text:"\u516C\u5171\u53C2\u6570",icon:"iconIconPopoverConfig",hrefFn:di},{text:"\u9879\u76EE\u6210\u5458",icon:"iconIconPopoverUser",hrefFn:li},{text:"\u5206\u4EAB\u9879\u76EE",icon:"iconshare2",onClick:()=>h()},{text:"\u5BFC\u51FA\u9879\u76EE",icon:"iconIconPopoverUpload",onClick:()=>A()},{text:"\u56DE\u6536\u7AD9",icon:"icontrash",hrefFn:ui}],k=b(C);return pe(i,()=>{i.value&&!r.value&&(k.value=C.filter(S=>S.icon!=="iconIconPopoverSetting"))},{immediate:!0}),(S,P)=>{const R=$e,F=qt,N=Wt,G=nc;return d(),g(V,null,[a("div",rc,[v(r)||v(l)?(d(),g(V,{key:0},[v(o)?(d(),g("div",ac,[a("img",{src:v(i).icon,alt:v(i).name},null,8,cc),a("a",{href:v(o)?"/iterations":"/home"},[p(R,{class:"ac-project-info__back"},{default:m(()=>[p(v(kt))]),_:1})],8,lc)])):(d(),$(F,{key:1,placement:"bottom","popper-class":"ac-popper-menu ac-popper-menu--large",width:"250px"},{reference:m(()=>[a("div",dc,[a("img",{src:v(i).icon,alt:v(i).name},null,8,uc),a("a",{href:v(o)?"/iterations":"/home"},[p(R,{class:"ac-project-info__back"},{default:m(()=>[p(v(kt))]),_:1})],8,hc)])]),default:m(()=>[a("ul",null,[(d(!0),g(V,null,ie(k.value,H=>(d(),g("li",{key:H.icon,class:B(["ac-popper-menu__item",{"border-t":H.divided}]),onClick:Q=>H.onClick?H.onClick(H):y(H)},[a("i",{class:B(["mr-1 icon iconfont",H.icon])},null,2),J(M(H.text),1)],10,pc))),128))])]),_:1}))],64)):(d(),g("div",fc,[a("img",{src:v(i).icon,alt:v(i).name},null,8,_c),a("a",{href:v(o)?"/iterations":"/home"},[p(R,{class:"ac-project-info__back"},{default:m(()=>[p(v(kt))]),_:1})],8,mc)])),v(o)&&v(n)?(d(),g(V,{key:2},[a("div",gc,[a("p",{class:"text-base truncate",title:v(i).name},M(v(i).name),9,vc),a("p",{class:"text-sm truncate",title:v(n).title},M(v(n).title),9,yc)]),v(c)?(d(),$(N,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[p(R,{size:16},{default:m(()=>[p(v(Ot))]),_:1})]),_:1})):T("",!0)],64)):(d(),g("div",{key:3,class:"ac-project-info__title",title:v(i).name},[J(M(v(i).name)+" ",1),v(c)?(d(),$(N,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[p(R,{class:"ac-project-info__icon"},{default:m(()=>[p(v(Ot))]),_:1})]),_:1})):T("",!0)],8,Ac))]),p(G,{ref_key:"projectShareModal",ref:_},null,512)],64)}}}),Cc={class:"ac-project-info"},kc={class:"ac-project-info__img"},Ic={href:"/"},wc=["src","alt"],bc=["title"],Nc=ee({setup(e){const t=re(),{projectInfo:s,isPrivate:o}=ne(t);return(n,i)=>{const r=$e,c=Wt;return d(),g("div",Cc,[a("div",kc,[a("a",Ic,[a("img",{src:v(s).icon,alt:v(s).name},null,8,wc)])]),a("div",{class:"ac-project-info__title",title:v(s).name},[J(M(v(s).name)+" ",1),v(o)?(d(),$(c,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[p(r,{class:"ac-project-info__icon"},{default:m(()=>[p(v(Ot))]),_:1})]),_:1})):T("",!0)],8,bc)])}}}),Dc="is.show.document.title",Pc="doc.save.ing",Sc="doc.save.done",jc="doc.save.error",Rc="doc.save.btn.ing",xc="doc.save.btn.done",Tc="doc.save.btn.error";var Se=$s();const Lc={class:"ac-header-operate"},Oc={class:"ac-header-operate__main"},Mc={key:1},Bc={key:0,class:"ac-header-operate__btns"},$c=ee({props:{title:{type:String,default:""}},setup(e){const t=ge("documentShareModal"),s=ge("projectExportModal"),{params:o}=Vt(),{currentRoute:n,push:i}=tt(),r=re(),{isIterateRoute:c}=Ne(),{isGuest:l,projectInfo:_}=ne(r),f=b(!1),u=b(!1),y=b(!1),A=Me(()=>["ac-header-operate__title",{hidden:!y.value,animate__slideInDown:y.value,animate__slideOutUp:!y.value}]),h=Me(()=>n.value.name===Te||n.value.name===Ie),C=()=>{const{params:N}=n.value,G=parseInt(N.node_id,10);return{iterate_id_public:N.iterate_id_public,project_id_public:N.project_id_public,node_id:G}},k=()=>{const{node_id:N}=C();if(h.value){u.value=!0,Se.emit(Rc);return}i({name:c?Ie:Te,params:Y(D({},o),{node_id:N})})},S=()=>{var G;const{node_id:N}=C();(G=t.value)==null||G.show({docId:N,nodeId:N})},P=()=>{const{node_id:N}=C();s.value.title="\u5BFC\u51FA\u6587\u6863",s.value.show({project_id:_.value.id,doc_id:N},fs)},R=()=>{f.value=!1},F=()=>{u.value=!1;const{node_id:N}=C();i({name:c?He:Le,params:Y(D({},o),{node_id:N})})};return Se.on(Dc,N=>{y.value=N}),Se.on(Pc,()=>{f.value=!0}),Se.on(Sc,R),Se.on(jc,R),Se.on(xc,F),Se.on(Tc,()=>{u.value=!1}),(N,G)=>{const H=st,Q=Wt;return d(),g("div",Lc,[a("div",Oc,[v(h)?(d(),g("p",Mc,[a("i",{class:B(["iconfont",f.value?"iconcloud-upload":"iconcloud"])},null,2),J(" "+M(f.value?"\u4FDD\u5B58\u4E2D...":"\u5DF2\u4FDD\u5B58\u5728\u4E91\u7AEF"),1)])):(d(),g("p",{key:0,class:B(v(A))},M(e.title),3))]),v(l)?T("",!0):(d(),g("div",Bc,[p(H,{type:"primary",onClick:k,loading:u.value},{default:m(()=>[J(M(v(h)?"\u9884\u89C8":"\u7F16\u8F91"),1)]),_:1},8,["loading"]),p(Q,{effect:"dark",content:"\u5206\u4EAB\u8BE5\u6587\u6863",placement:"bottom"},{default:m(()=>[a("i",{class:"iconfont iconshare2",onClick:S})]),_:1}),p(Q,{effect:"dark",content:"\u5BFC\u51FA\u8BE5\u6587\u6863",placement:"bottom"},{default:m(()=>[a("i",{class:"iconfont iconIconPopoverUpload",onClick:P})]),_:1})]))])}}}),Fc={emits:["on-menu-item-click"],name:"NewMenus",props:{node:{type:Object,default:()=>({})}},setup(){return{menus:vs}},methods:{onPopperItemClick(e){Gt(this,"on-menu-item-click",e)}}},Kc={class:"ac-popper-menu"},Uc=["onClick"],Vc=["src"];function Gc(e,t,s,o,n,i){return d(),g("ul",Kc,[(d(!0),g(V,null,ie(o.menus,r=>(d(),g(V,{key:r.value},[s.node.level<5||s.node.level===5&&r.value!=="newCatetory"?(d(),g("li",{key:0,class:B(["ac-popper-menu__item",{"border-t":r.divided}]),onClick:ce(c=>i.onPopperItemClick(r),["stop"])},[r.icon?(d(),g("span",{key:0,class:B(["icon iconfont ac-popper-menu__icon",r.icon])},null,2)):T("",!0),r.img?(d(),g("img",{key:1,class:"ac-popper-menu__icon",src:r.img,alt:""},null,8,Vc)):T("",!0),J(M(r.text),1)],10,Uc)):T("",!0)],64))),128))])}var Hc=Z(Fc,[["render",Gc]]);const Yc={name:"DirOperateMenus",data(){return{menus:il}},methods:{onPopperItemClick(e){Gt(this,"on-menu-item-click",e)}}},zc={class:"ac-popper-menu ac-popper-menu--thin"},Jc=["onClick"];function qc(e,t,s,o,n,i){return d(),g("ul",zc,[(d(!0),g(V,null,ie(n.menus,r=>(d(),g("li",{class:B(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},M(r.text),11,Jc))),128))])}var Wc=Z(Yc,[["render",qc]]);const Zc={emits:["on-menu-item-click"],name:"DocOperateMenus",props:{node:{type:Object,default:()=>({})},source:{type:Object,default:()=>({})},isDetailPage:{type:Boolean,default:!1}},data(){return{menus:$t}},methods:{onPopperItemClick(e){Gt(this,"on-menu-item-click",e)}}},Qc={class:"ac-popper-menu ac-popper-menu--thin"},Xc=["onClick"],el=["onClick"],tl=["onClick"];function ol(e,t,s,o,n,i){return d(),g("ul",Qc,[(d(!0),g(V,null,ie(n.menus,r=>(d(),g(V,null,[(r.value==="delete"||r.value==="export"||r.value==="share"||r.value==="copy")&&s.isDetailPage&&s.source.isCurrent?(d(),g("li",{class:B(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},M(r.text),11,Xc)):T("",!0),r.value==="delete"&&!s.isDetailPage&&s.source.isCurrent?(d(),g("li",{class:B(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},M(r.text),11,el)):T("",!0),s.source.isCurrent?T("",!0):(d(),g("li",{class:B(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},M(r.text),11,tl))],64))),256))])}var sl=Z(Zc,[["render",ol]]),gs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUGVYSWZNTQAqAAAACAACARIAAwAAAAEAAQAAh2kABAAAAAEAAAAmAAAAAAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAAgoAMABAAAAAEAAAAgAAAAAL5bTO0AAAIwaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4K9GTeTwAAAW9JREFUWAntVLtKQ0EQvWsUi0AKtRFESaWlP2Nl/AMLK62sbExhlz+I8XusxE6sfRRBCxuv50guXJKZfS8IZuBw787ZmTk7+6iq/25GacA5/IcKZ3O/gxwBj7ZJbW6lPWj9xxRn+AZwARxw4GNaB+5mwWN8nx2J9sEfAVz9N7AFfAFDwNmJVUyyGYs/2CaA6874D3xvgEuAItgJpwhtCxAbZS+IugJegXXAuR25BaBmFSSihIAgEaUESCJO6Zw31yGcn28bb4O8FiY0i+QVXbAcAp6QlddvDdhdqOBw5BDAE38G9JVaO/DznRAthwAmpghCsk/J2fia/WnGoV++pEk5UjtQQwARbb7qO9EVHIG+ApJWadPgK4DXrIj5CihSnEmXApYdCOpAXdfm9vitp51Icpyj8ZI/6CU0xvA9mEqJ6BtMNqeDicbK/qAOyCnSvK4O7KWl/4225nAJOMkgwJpC24J7a1QcWSJnnJI/FfUDsbg5OtwYRrcAAAAASUVORK5CYII=",nl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABZUlEQVRYR+3XMUvEMBTA8X9uvkHE2wQRBMHJQScdHO4rCCL4DTp4izgoOLh4KBxSP4HgZ3AQXHRzcBJXXVxEHE8FI4EuXtt7LyGhg3ZsXvJ+eU3T1NDwZRrOTx1gB1gMwL0BOfCo7VsHuNAOUBH3ARxpERLgHHgSMPPAOuBm/w1MAWqEBDgEHgTAMtADnoETYN8HERuwC3R8ECkArmBqRCqAGpESMIpwizQbXU8xAV/AS8WCbQOTxf3NFAD32g2AlmLvSAJweR1itgYwXewTrjkZYNzkF4C9lI9AqnwEQGaXsFxJmX61G7rk5g6IAljBcuMJWCU3t3EALvO2nfACDMx7ER+hAl6ZS8ERAD07xyfHpaENQ3KzIfgiADK7huW6MtGZkY51EQAHts0r3RKgxZBTc5m+Ao2vgX/AX66A5lgu1WcG2Ar9GkqD+7arzwOhv2bjQPdAX3sk851ZcLy0jQYPrO34A6sFhSHFThBJAAAAAElFTkSuQmCC";const vs=[{text:"\u65B0\u5EFA\u6587\u6863",value:"createDoc",img:gs,onClick:"createDoc"},{text:"\u65B0\u5EFA HTTP API \u6587\u6863",value:"createHttpDoc",img:nl,onClick:"createHttpDoc"},{text:"\u5BFC\u5165\u6587\u4EF6",value:"importFile",icon:"iconimport",onClick:"onImportBtnClick",divided:!0},{text:"\u65B0\u5EFA\u5206\u7C7B",value:"newCatetory",type:"newCatetory",icon:"iconIconPopoverTree",onClick:"onCreateDirBtnClick",divided:!0}],$t=[{text:"\u590D\u5236",value:"copy",onClick:"onCopyBtnClick"},{text:"\u91CD\u547D\u540D",value:"rename",onClick:"onRenameBtnClick"},{text:"\u5206\u4EAB",value:"share",onClick:"onShareBtnClick"},{text:"\u5BFC\u51FA",value:"export",onClick:"onExportBtnClick"},{text:"\u5220\u9664",value:"delete",onClick:"onDeleteBtnClick"}],il=[$t[1],$t[4]],rl="DIR_NEW_TYPE",al="DIR_OPERATE_TYPE",cl="DOC_OPERATE_TYPE";function jt(e,t){const s=document.createElement("div"),o=Tt(e);return Fs(o,s),Object.keys(t).forEach(n=>{o.component.props[n]=t[n]}),o}var ll={[rl]:{render(e){return jt(Hc,e)}},[al]:{render(e){return jt(Wc,e)}},[cl]:{render(e){return jt(sl,e)}}},Rt={onPopperItemClick:qe,onPopperHide:qe,popper:Ks(document.body,{appendTo:()=>document.body,trigger:"manual",placement:"bottom",interactive:!0,theme:"light",zIndex:10}),show(e,t,s,o){const n=ll[e];!n||(this.$vm=n.render(s),Us(this.$vm.component.proxy,"on-menu-item-click",i=>{this.onPopperItemClick(D({menu:i},s)),this.hide()}),this.popper.setProps({appendTo:()=>o||document.body,getReferenceClientRect:()=>t.getBoundingClientRect(),content:this.$vm.el,onHide:()=>{this.onPopperHide()}}),this.popper.show())},hide(){this.popper.hide()}};const dl=(e={})=>E.post("/dir/create",e),ul=(e={})=>E.post("/dir/remove",e),hl=(e={})=>E.post("/dir/rename",e),pl=(e={})=>E.post("/api_tree/sort",e),fl=(e,t)=>E.get("/api_tree",{params:Y(D({},e||{}),{token:t})}),Zu=e=>E.get("/dir/list",{params:{project_id:e}}),ut=(e={},t=xe.DOC)=>Y(D({},e),{type:e.type===void 0?t:e.type,isEditable:!1,isCurrent:!1,isLeaf:(e.type===void 0?t:e.type)===xe.DOC,title:e.title||e.name}),ys=Be({id:"document",state:()=>({apiDocTree:[]}),getters:{},actions:{async getApiDocTree(e){if(!e)return[];try{const t=j.get(j.KEYS.SECRET_PROJECT_TOKEN+e||"",!0),{data:s}=await fl(e,t);this.apiDocTree=Re(o=>(o.isLeaf=o.type===xe.DOC,o.isEditable=!1,o.isCurrent=!1,o),s||[],{subKey:"sub_nodes"})}catch{}return this.apiDocTree}}}),_l="el",ml="is-",je=(e,t,s,o,n)=>{let i=`${e}-${t}`;return s&&(i+=`-${s}`),o&&(i+=`__${o}`),n&&(i+=`--${n}`),i},at=e=>{const t=Me(()=>_l);return{namespace:t,b:(h="")=>je(v(t),e,h,"",""),e:h=>h?je(v(t),e,"",h,""):"",m:h=>h?je(v(t),e,"","",h):"",be:(h,C)=>h&&C?je(v(t),e,h,C,""):"",em:(h,C)=>h&&C?je(v(t),e,"",h,C):"",bm:(h,C)=>h&&C?je(v(t),e,h,"",C):"",bem:(h,C,k)=>h&&C&&k?je(v(t),e,h,C,k):"",is:(h,...C)=>{const k=C.length>=1?C[0]:!0;return h&&k?`${ml}${h}`:""},cssVar:h=>{const C={};for(const k in h)C[`--${t.value}-${k}`]=h[k];return C},cssVarName:h=>`--${t.value}-${h}`,cssVarBlock:h=>{const C={};for(const k in h)C[`--${t.value}-${e}-${k}`]=h[k];return C},cssVarBlockName:h=>`--${t.value}-${e}-${h}`}},gl=(e,t,s,o=!1)=>{e&&t&&s&&(e==null||e.addEventListener(t,s,o))},vl=(e,t,s,o=!1)=>{e&&t&&s&&(e==null||e.removeEventListener(t,s,o))},Ge="$treeNodeId",ko=function(e,t){!t||t[Ge]||Object.defineProperty(t,Ge,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},so=function(e,t){return e?t[e]:t[Ge]},Ft=e=>{let t=!0,s=!0,o=!0;for(let n=0,i=e.length;n<i;n++){const r=e[n];(r.checked!==!0||r.indeterminate)&&(t=!1,r.disabled||(o=!1)),(r.checked!==!1||r.indeterminate)&&(s=!1)}return{all:t,none:s,allWithoutDisable:o,half:!t&&!s}},_t=function(e){if(e.childNodes.length===0)return;const{all:t,none:s,half:o}=Ft(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):o?(e.checked=!1,e.indeterminate=!0):s&&(e.checked=!1,e.indeterminate=!1);const n=e.parent;!n||n.level===0||e.store.checkStrictly||_t(n)},ht=function(e,t){const s=e.store.props,o=e.data||{},n=s[t];if(typeof n=="function")return n(o,e);if(typeof n=="string")return o[n];if(typeof n=="undefined"){const i=o[t];return i===void 0?"":i}};let yl=0;class Oe{constructor(t){O(this,"id");O(this,"text");O(this,"checked");O(this,"indeterminate");O(this,"data");O(this,"expanded");O(this,"parent");O(this,"visible");O(this,"isCurrent");O(this,"store");O(this,"isLeafByUser");O(this,"isLeaf");O(this,"canFocus");O(this,"level");O(this,"loaded");O(this,"childNodes");O(this,"loading");this.id=yl++,this.text=void 0,this.checked=!1,this.indeterminate=!1,this.data=void 0,this.expanded=!1,this.parent=void 0,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const s in t)Lt(t,s)&&(this[s]=t[s]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const s=t.props;if(s&&typeof s.isLeaf!="undefined"){const i=ht(this,"isLeaf");typeof i=="boolean"&&(this.isLeafByUser=i)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||ko(this,this.data),!this.data)return;const o=t.defaultExpandedKeys,n=t.key;n&&o&&o.includes(this.key)&&this.expand(void 0,t.autoExpandParent),n&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||ko(this,t),this.data=t,this.childNodes=[];let s;this.level===0&&Array.isArray(this.data)?s=this.data:s=ht(this,"children")||[];for(let o=0,n=s.length;o<n;o++)this.insertChild({data:s[o]})}get label(){return ht(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return ht(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const s=t.childNodes.indexOf(this);if(s>-1)return t.childNodes[s+1]}return null}get previousSibling(){const t=this.parent;if(t){const s=t.childNodes.indexOf(this);if(s>-1)return s>0?t.childNodes[s-1]:null}return null}contains(t,s=!0){return(this.childNodes||[]).some(o=>o===t||s&&o.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,s,o){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof Oe)){if(!o){const n=this.getChildren(!0);n.includes(t.data)||(typeof s=="undefined"||s<0?n.push(t.data):n.splice(s,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=Kt(new Oe(t)),t instanceof Oe&&t.initialize()}t.level=this.level+1,typeof s=="undefined"||s<0?this.childNodes.push(t):this.childNodes.splice(s,0,t),this.updateLeafState()}insertBefore(t,s){let o;s&&(o=this.childNodes.indexOf(s)),this.insertChild(t,o)}insertAfter(t,s){let o;s&&(o=this.childNodes.indexOf(s),o!==-1&&(o+=1)),this.insertChild(t,o)}removeChild(t){const s=this.getChildren()||[],o=s.indexOf(t.data);o>-1&&s.splice(o,1);const n=this.childNodes.indexOf(t);n>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(t){let s=null;for(let o=0;o<this.childNodes.length;o++)if(this.childNodes[o].data===t){s=this.childNodes[o];break}s&&this.removeChild(s)}expand(t,s){const o=()=>{if(s){let n=this.parent;for(;n.level>0;)n.expanded=!0,n=n.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(n=>{n.canFocus=!0})};this.shouldLoadData()?this.loadData(n=>{Array.isArray(n)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||_t(this),o())}):o()}doCreateChildren(t,s={}){t.forEach(o=>{this.insertChild(Object.assign({data:o},s),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(typeof this.isLeafByUser!="undefined"){this.isLeaf=this.isLeafByUser;return}this.isLeaf=!1}setChecked(t,s,o,n){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:r,allWithoutDisable:c}=Ft(this.childNodes);!this.isLeaf&&!r&&c&&(this.checked=!1,t=!1);const l=()=>{if(s){const _=this.childNodes;for(let y=0,A=_.length;y<A;y++){const h=_[y];n=n||t!==!1;const C=h.disabled?h.checked:n;h.setChecked(C,s,!0,n)}const{half:f,all:u}=Ft(_);u||(this.checked=u,this.indeterminate=f)}};if(this.shouldLoadData()){this.loadData(()=>{l(),_t(this)},{checked:t!==!1});return}else l()}const i=this.parent;!i||i.level===0||o||_t(i)}getChildren(t=!1){if(this.level===0)return this.data;const s=this.data;if(!s)return null;const o=this.store.props;let n="children";return o&&(n=o.children||"children"),s[n]===void 0&&(s[n]=null),t&&!s[n]&&(s[n]=[]),s[n]}updateChildren(){const t=this.getChildren()||[],s=this.childNodes.map(i=>i.data),o={},n=[];t.forEach((i,r)=>{const c=i[Ge];!!c&&s.findIndex(_=>_[Ge]===c)>=0?o[c]={index:r,data:i}:n.push({index:r,data:i})}),this.store.lazy||s.forEach(i=>{o[i[Ge]]||this.removeChildByData(i)}),n.forEach(({index:i,data:r})=>{this.insertChild({data:r},i)}),this.updateLeafState()}loadData(t,s={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(s).length)){this.loading=!0;const o=n=>{this.loaded=!0,this.loading=!1,this.childNodes=[],this.doCreateChildren(n,s),this.updateLeafState(),t&&t.call(this,n)};this.store.load(this,o)}else t&&t.call(this)}}class Al{constructor(t){O(this,"currentNode");O(this,"currentNodeKey");O(this,"nodesMap");O(this,"root");O(this,"data");O(this,"lazy");O(this,"load");O(this,"filterNodeMethod");O(this,"key");O(this,"defaultCheckedKeys");O(this,"checkStrictly");O(this,"defaultExpandedKeys");O(this,"autoExpandParent");O(this,"defaultExpandAll");O(this,"checkDescendants");O(this,"props");this.currentNode=null,this.currentNodeKey=null;for(const s in t)Lt(t,s)&&(this[s]=t[s]);this.nodesMap={}}initialize(){this.root=new Oe({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load?this.load(this.root,s=>{this.root.doCreateChildren(s),this._initDefaultCheckedNodes()}):this._initDefaultCheckedNodes()}filter(t){const s=this.filterNodeMethod,o=this.lazy,n=function(i){const r=i.root?i.root.childNodes:i.childNodes;if(r.forEach(c=>{c.visible=s.call(c,t,c.data,c),n(c)}),!i.visible&&r.length){let c=!0;c=!r.some(l=>l.visible),i.root?i.root.visible=c===!1:i.visible=c===!1}!t||i.visible&&!i.isLeaf&&!o&&i.expand()};n(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof Oe)return t;const s=typeof t!="object"?t:so(this.key,t);return this.nodesMap[s]||null}insertBefore(t,s){const o=this.getNode(s);o.parent.insertBefore({data:t},o)}insertAfter(t,s){const o=this.getNode(s);o.parent.insertAfter({data:t},o)}remove(t){const s=this.getNode(t);s&&s.parent&&(s===this.currentNode&&(this.currentNode=null),s.parent.removeChild(s))}append(t,s){const o=s?this.getNode(s):this.root;o&&o.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],s=this.nodesMap;t.forEach(o=>{const n=s[o];n&&n.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const s=this.key;!t||!t.data||(s?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(o=>{this.deregisterNode(o)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,s=!1){const o=[],n=function(i){(i.root?i.root.childNodes:i.childNodes).forEach(c=>{(c.checked||s&&c.indeterminate)&&(!t||t&&c.isLeaf)&&o.push(c.data),n(c)})};return n(this),o}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(s=>(s||{})[this.key])}getHalfCheckedNodes(){const t=[],s=function(o){(o.root?o.root.childNodes:o.childNodes).forEach(i=>{i.indeterminate&&t.push(i.data),s(i)})};return s(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],s=this.nodesMap;for(const o in s)Lt(s,o)&&t.push(s[o]);return t}updateChildren(t,s){const o=this.nodesMap[t];if(!o)return;const n=o.childNodes;for(let i=n.length-1;i>=0;i--){const r=n[i];this.remove(r.data)}for(let i=0,r=s.length;i<r;i++){const c=s[i];this.append(c,o.data)}}_setCheckedKeys(t,s=!1,o){const n=this._getAllNodes().sort((c,l)=>l.level-c.level),i=Object.create(null),r=Object.keys(o);n.forEach(c=>c.setChecked(!1,!1));for(let c=0,l=n.length;c<l;c++){const _=n[c],f=_.data[t].toString();if(!r.includes(f)){_.checked&&!i[f]&&_.setChecked(!1,!1);continue}let y=_.parent;for(;y&&y.level>0;)i[y.data[t]]=!0,y=y.parent;if(_.isLeaf||this.checkStrictly){_.setChecked(!0,!1);continue}if(_.setChecked(!0,!0),s){_.setChecked(!1,!1);const A=function(h){h.childNodes.forEach(k=>{k.isLeaf||k.setChecked(!1,!1),A(k)})};A(_)}}}setCheckedNodes(t,s=!1){const o=this.key,n={};t.forEach(i=>{const r=i||{};n[r[o]]=!0}),this._setCheckedKeys(o,s,n)}setCheckedKeys(t,s=!1){this.defaultCheckedKeys=t;const o=this.key,n={};t.forEach(i=>{n[i]=!0}),this._setCheckedKeys(o,s,n)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(s=>{const o=this.getNode(s);o&&o.expand(void 0,this.autoExpandParent)})}setChecked(t,s,o){const n=this.getNode(t);n&&n.setChecked(!!s,o)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const s=this.currentNode;s&&(s.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,s=!0){const o=t[this.key],n=this.nodesMap[o];this.setCurrentNode(n),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,s=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const o=this.getNode(t);o&&(this.setCurrentNode(o),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const El=ee({name:"AcTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=at("tree"),s=ge("NodeInstance"),o=ge("RootTree");return()=>{const n=e.node,{data:i,store:r}=n;return e.renderContent?e.renderContent(Tt,{_self:s,node:n,data:i,store:r}):o.ctx.slots.default?o.ctx.slots.default({node:n,data:i}):Tt("span",{class:t.be("node","label")},[n.label])}}});function As(e){const t=ge("TreeNodeMap",void 0),s={treeNodeExpand:o=>{e.node!==o&&e.node.collapse()},children:[]};return t&&t.children.push(s),ue("TreeNodeMap",s),{broadcastExpanded:o=>{if(!!e.accordion)for(const n of s.children)n.treeNodeExpand(o)}}}const Es=Symbol("dragEvents");function Cl({props:e,ctx:t,el$:s,dropIndicator$:o,store:n}){const i=at("tree"),r=b({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return ue(Es,{treeNodeDragStart:({event:f,treeNode:u})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(u.node))return f.preventDefault(),!1;f.dataTransfer.effectAllowed="move";try{f.dataTransfer.setData("text/plain","")}catch{}r.value.draggingNode=u,t.emit("node-drag-start",u.node,f)},treeNodeDragOver:({event:f,treeNode:u})=>{const y=u,A=r.value.dropNode;A&&A!==y&&Ct(A.$el,i.is("drop-inner"));const h=r.value.draggingNode;if(!h||!y)return;let C=!0,k=!0,S=!0,P=!0;typeof e.allowDrop=="function"&&(C=e.allowDrop(h.node,y.node,"prev"),P=k=e.allowDrop(h.node,y.node,"inner"),S=e.allowDrop(h.node,y.node,"next")),f.dataTransfer.dropEffect=k||C||S?"move":"none",(C||k||S)&&A!==y&&(A&&t.emit("node-drag-leave",h.node,A.node,f),t.emit("node-drag-enter",h.node,y.node,f)),(C||k||S)&&(r.value.dropNode=y),y.node.nextSibling===h.node&&(S=!1),y.node.previousSibling===h.node&&(C=!1),y.node.contains(h.node,!1)&&(k=!1),(h.node===y.node||h.node.contains(y.node))&&(C=!1,k=!1,S=!1);const R=y.$el.getBoundingClientRect(),F=s.value.getBoundingClientRect();let N;const G=C?k?.25:S?.45:1:-1,H=S?k?.75:C?.55:0:1;let Q=-9999;const w=f.clientY-R.top;w<R.height*G?N="before":w>R.height*H?N="after":k?N="inner":N="none";const U=y.$el.querySelector(`.${i.be("node","expand-icon")}`).getBoundingClientRect(),W=o.value;N==="before"?Q=U.top-F.top:N==="after"&&(Q=U.bottom-F.top),W.style.top=`${Q}px`,W.style.left=`${U.right-F.left}px`,N==="inner"?Vs(y.$el,i.is("drop-inner")):Ct(y.$el,i.is("drop-inner")),r.value.showDropIndicator=N==="before"||N==="after",r.value.allowDrop=r.value.showDropIndicator||P,r.value.dropType=N,t.emit("node-drag-over",h.node,y.node,f)},treeNodeDragEnd:f=>{const{draggingNode:u,dropType:y,dropNode:A}=r.value;if(f.preventDefault(),f.dataTransfer.dropEffect="move",u&&A){const h={data:u.node.data};y!=="none"&&u.node.remove(),y==="before"?A.node.parent.insertBefore(h,A.node):y==="after"?A.node.parent.insertAfter(h,A.node):y==="inner"&&A.node.insertChild(h),y!=="none"&&n.value.registerNode(h),Ct(A.$el,i.is("drop-inner")),t.emit("node-drag-end",u.node,A.node,y,f),y!=="none"&&t.emit("node-drop",u.node,A.node,y,f)}u&&!A&&t.emit("node-drag-end",u.node,null,y,f),r.value.showDropIndicator=!1,r.value.draggingNode=null,r.value.dropNode=null,r.value.allowDrop=!0}}),{dragState:r}}const kl=ee({name:"AcTreeNode",components:{NodeContent:El,Loading:_n},props:{node:{type:Oe,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const s=at("tree"),{broadcastExpanded:o}=As(e),n=ge("RootTree"),i=b(!1),r=b(!1),c=b(!1),l=b(!1),_=b(null),f=ge(Es),u=Do();ue("NodeInstance",u),e.node.expanded&&(i.value=!0,r.value=!0);const y=n.props.children||"children";pe(()=>{const w=e.node.data[y];return w&&[...w]},()=>{e.node.updateChildren()}),pe(()=>e.node.indeterminate,w=>{C(e.node.checked,w)}),pe(()=>e.node.checked,w=>{C(w,e.node.indeterminate)}),pe(()=>e.node.expanded,w=>{mt(()=>i.value=w),w&&(r.value=!0)});const A=w=>so(n.props.nodeKey,w.data),h=w=>{const U=e.props.class;if(!U)return{};let W;if(Gs(U)){const{data:le}=w;W=U(le,w)}else W=U;return Hs(W)?{[W]:!0}:W},C=(w,U)=>{(c.value!==w||l.value!==U)&&n.ctx.emit("check-change",e.node.data,w,U),c.value=w,l.value=U},k=w=>{const U=n.store.value;U.setCurrentNode(e.node),n.ctx.emit("current-change",U.currentNode?U.currentNode.data:null,U.currentNode),n.currentNode.value=e.node,n.props.expandOnClickNode&&P(),n.props.checkOnClickNode&&!e.node.disabled&&R(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,u,w)},S=w=>{n.instance.vnode.props.onNodeContextmenu&&(w.stopPropagation(),w.preventDefault()),n.ctx.emit("node-contextmenu",w,e.node.data,e.node,u)},P=()=>{e.node.isLeaf||(i.value?(n.ctx.emit("node-collapse",e.node.data,e.node,u),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,u)))},R=(w,U)=>{e.node.setChecked(U.target.checked,!n.props.checkStrictly),mt(()=>{const W=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:W.getCheckedNodes(),checkedKeys:W.getCheckedKeys(),halfCheckedNodes:W.getHalfCheckedNodes(),halfCheckedKeys:W.getHalfCheckedKeys()})})};return{ns:s,node$:_,tree:n,expanded:i,childNodeRendered:r,oldChecked:c,oldIndeterminate:l,getNodeKey:A,getNodeClass:h,handleSelectChange:C,handleClick:k,handleContextMenu:S,handleExpandIconClick:P,handleCheckChange:R,handleChildNodeExpand:(w,U,W)=>{o(U),n.ctx.emit("node-expand",w,U,W)},handleDragStart:w=>{!n.props.draggable||f.treeNodeDragStart({event:w,treeNode:e})},handleDragOver:w=>{w.preventDefault(),n.props.draggable&&f.treeNodeDragOver({event:w,treeNode:{$el:_.value,node:e.node}})},handleDrop:w=>{w.preventDefault()},handleDragEnd:w=>{!n.props.draggable||f.treeNodeDragEnd(w)},CaretRight:mn}}}),Il=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],wl=["aria-expanded"];function bl(e,t,s,o,n,i){const r=$e,c=gn,l=X("loading"),_=X("node-content"),f=X("ac-tree-node");return te((d(),g("div",{ref:"node$",class:B([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=ce((...u)=>e.handleClick&&e.handleClick(...u),["stop"])),onContextmenu:t[2]||(t[2]=(...u)=>e.handleContextMenu&&e.handleContextMenu(...u)),onDragstart:t[3]||(t[3]=ce((...u)=>e.handleDragStart&&e.handleDragStart(...u),["stop"])),onDragover:t[4]||(t[4]=ce((...u)=>e.handleDragOver&&e.handleDragOver(...u),["stop"])),onDragend:t[5]||(t[5]=ce((...u)=>e.handleDragEnd&&e.handleDragEnd(...u),["stop"])),onDrop:t[6]||(t[6]=ce((...u)=>e.handleDrop&&e.handleDrop(...u),["stop"]))},[a("div",{class:B(e.ns.be("node","content")),style:Po({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(d(),$(r,{key:0,class:B([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:ce(e.handleExpandIconClick,["stop"])},{default:m(()=>[(d(),$(Ys(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):T("",!0),e.showCheckbox?(d(),$(c,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=ce(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):T("",!0),e.node.loading?(d(),$(r,{key:2,class:B([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:m(()=>[p(l)]),_:1},8,["class"])):T("",!0),p(_,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),!e.renderAfterExpand||e.childNodeRendered?te((d(),g("div",{key:0,class:B(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(d(!0),g(V,null,ie(e.node.childNodes,u=>(d(),$(f,{key:e.getNodeKey(u),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:u,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,wl)),[[he,e.expanded]]):T("",!0)],42,Il)),[[he,e.node.visible]])}var Nl=Z(kl,[["render",bl]]);function Dl({el$:e},t){const s=at("tree"),o=_o([]),n=_o([]);et(()=>{r(),gl(e.value,"keydown",i)}),zs(()=>{vl(e.value,"keydown",i)}),Js(()=>{o.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),pe(n,c=>{c.forEach(l=>{l.setAttribute("tabindex","-1")})});const i=c=>{const l=c.target;if(!l.className.includes(s.b("node")))return;const _=c.code;o.value=Array.from(e.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`));const f=o.value.indexOf(l);let u;if([Pe.up,Pe.down].includes(_)){if(c.preventDefault(),_===Pe.up){u=f===-1?0:f!==0?f-1:o.value.length-1;const A=u;for(;!t.value.getNode(o.value[u].dataset.key).canFocus;){if(u--,u===A){u=-1;break}u<0&&(u=o.value.length-1)}}else{u=f===-1?0:f<o.value.length-1?f+1:0;const A=u;for(;!t.value.getNode(o.value[u].dataset.key).canFocus;){if(u++,u===A){u=-1;break}u>=o.value.length&&(u=0)}}u!==-1&&o.value[u].focus()}[Pe.left,Pe.right].includes(_)&&(c.preventDefault(),l.click());const y=l.querySelector('[type="checkbox"]');[Pe.enter,Pe.space].includes(_)&&y&&(c.preventDefault(),y.click())},r=()=>{var l;o.value=Array.from(e.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`)),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const c=e.value.querySelectorAll(`.${s.is("checked")}[role=treeitem]`);if(c.length){c[0].setAttribute("tabindex","0");return}(l=o.value[0])==null||l.setAttribute("tabindex","0")}}const Pl=ee({name:"AcTree",components:{AcTreeNode:Nl},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:[String,Object]},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const s=at("tree"),o=b(new Al({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));o.value.initialize();const n=b(o.value.root),i=b(null),r=b(null),c=b(null),{broadcastExpanded:l}=As(e),{dragState:_}=Cl({props:e,ctx:t,el$:r,dropIndicator$:c,store:o});Dl({el$:r},o);const f=Me(()=>{const{childNodes:I}=n.value;return!I||I.length===0||I.every(({visible:K})=>!K)});pe(()=>e.defaultCheckedKeys,I=>{o.value.setDefaultCheckedKey(I)}),pe(()=>e.defaultExpandedKeys,I=>{o.value.setDefaultExpandedKeys(I)}),pe(()=>e.data,I=>{o.value.setData(I)},{deep:!0}),pe(()=>e.checkStrictly,I=>{o.value.checkStrictly=I});const u=I=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");o.value.filter(I)},y=I=>so(e.nodeKey,I.data),A=I=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const K=o.value.getNode(I);if(!K)return[];const ye=[K.data];let De=K.parent;for(;De&&De!==n.value;)ye.push(De.data),De=De.parent;return ye.reverse()},h=(I,K)=>o.value.getCheckedNodes(I,K),C=I=>o.value.getCheckedKeys(I),k=()=>{const I=o.value.getCurrentNode();return I?I.data:null},S=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const I=k();return I?I[e.nodeKey]:null},P=(I,K)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");o.value.setCheckedNodes(I,K)},R=(I,K)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");o.value.setCheckedKeys(I,K)},F=(I,K,ye)=>{o.value.setChecked(I,K,ye)},N=()=>o.value.getHalfCheckedNodes(),G=()=>o.value.getHalfCheckedKeys(),H=(I,K=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");o.value.setUserCurrentNode(I,K)},Q=(I,K=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");o.value.setCurrentNodeKey(I,K)},w=I=>o.value.getNode(I),U=I=>{o.value.remove(I)},W=(I,K)=>{o.value.append(I,K)},le=(I,K)=>{o.value.insertBefore(I,K)},Ye=(I,K)=>{o.value.insertAfter(I,K)},lt=(I,K,ye)=>{l(K),t.emit("node-expand",I,K,ye)},At=(I,K)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");o.value.updateChildren(I,K)};return ue("RootTree",{ctx:t,props:e,store:o,root:n,currentNode:i,instance:Do()}),{ns:s,store:o,root:n,currentNode:i,dragState:_,el$:r,dropIndicator$:c,isEmpty:f,filter:u,getNodeKey:y,getNodePath:A,getCheckedNodes:h,getCheckedKeys:C,getCurrentNode:k,getCurrentKey:S,setCheckedNodes:P,setCheckedKeys:R,setChecked:F,getHalfCheckedNodes:N,getHalfCheckedKeys:G,setCurrentNode:H,setCurrentKey:Q,getNode:w,remove:U,append:W,insertBefore:le,insertAfter:Ye,handleNodeExpand:lt,updateKeyChildren:At}}});function Sl(e,t,s,o,n,i){var c;const r=X("ac-tree-node");return d(),g("div",{ref:"el$",class:B([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(d(!0),g(V,null,ie(e.root.childNodes,l=>(d(),$(r,{key:e.getNodeKey(l),node:l,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(d(),g("div",{key:0,class:B(e.ns.e("empty-block"))},[a("span",{class:B(e.ns.e("empty-text"))},M((c=e.emptyText)!=null?c:"\u6682\u65E0\u6570\u636E"),3)],2)):T("",!0),te(a("div",{ref:"dropIndicator$",class:B(e.ns.e("drop-indicator"))},null,2),[[he,e.dragState.showDropIndicator]])],2)}var jl=Z(Pl,[["render",Sl]]);const Rl={props:{status:{type:String,default:()=>"success",validate(e){return["success","error"].indexOf(e)!==-1}},title:{type:String,default:()=>""},subTitle:{type:String,default:()=>""},styles:{type:Object,default:()=>({})}}},xl={class:"result"},Tl={class:"result-title"},Ll={class:"mt-1 result-subtitle"};function Ol(e,t,s,o,n,i){return d(),g("div",xl,[a("div",{class:"result-icon",style:Po(s.styles)},[ft(e.$slots,"icon",{},void 0,!0)],4),ft(e.$slots,"title",{},()=>[a("p",Tl,M(s.title),1)],!0),a("p",Ll,[ft(e.$slots,"subTitle",{},()=>[J(M(s.subTitle),1)],!0)])])}var Ml=Z(Rl,[["render",Ol],["__scopeId","data-v-a27469de"]]),Cs="/assets/icon-no-result.4a7ec4ce.png";const ks=e=>(Qe("data-v-59b62b74"),e=e(),Xe(),e),Bl={class:"text-left search-result scroll-content"},$l=["onClick"],Fl={class:"px-2 truncate hover:bg-gray-100"},Kl=ks(()=>a("img",{src:Cs},null,-1)),Ul=ks(()=>a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1)),Vl=ee({props:{virtualRef:Object},setup(e,{expose:t}){const s=e,{push:o}=tt(),{apiDocTree:n}=ne(ys()),i=_s(),r=ms(),{isIterateRoute:c}=i,l=b(!1),_=b(!1),f=b(""),u=b([]),y=b(),A=b(),h=b(),C=Ut(s),k={modifiers:[{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"offset",options:{offset:[-300,10]}}]};wo(y,()=>P(),{ignore:[C.virtualRef]});const S=Ht(()=>{const G=v(f);if(G.length<2)return;l.value=!0,_.value=!0;const H=Ee(i);H.project_id_public=i.projectPublicId,Na(H,G).then(Q=>{u.value=Q.data||[]}).catch(Q=>{}).finally(()=>{_.value=!1})},200),P=()=>{u.value=[],f.value="",l.value=!1},R=G=>{let H=null;Re(w=>{if(w.id===parseInt(G.doc_id,10))return H=w,!1},n.value||[],{subKey:"sub_nodes"});const Q=c?Oi(r,G.doc_id):hs(r,G.doc_id);H?o({path:Q}):location.href=Q},F=()=>{h.value.focus()},N=()=>{P()};return t({onShow:F,onHide:N}),(G,H)=>{const Q=yt,w=Ml,U=qt,W=nt;return d(),$(U,{ref_key:"popoverRef",ref:A,placement:"bottom-end",trigger:"click","virtual-ref":s.virtualRef,"virtual-triggering":"",width:"auto","popper-options":k,onAfterEnter:F,onAfterLeave:N},{default:m(()=>[a("div",{ref_key:"searchDomRef",ref:y,class:"search-poptip"},[p(Q,{ref_key:"searchInput",ref:h,"suffix-icon":v(Oo),placeholder:"\u5173\u952E\u5B57 \u56DE\u8F66\u641C\u7D22",modelValue:f.value,"onUpdate:modelValue":H[0]||(H[0]=le=>f.value=le),onChange:v(S),clearable:""},null,8,["suffix-icon","modelValue","onChange"]),te((d(),g("div",Bl,[(d(!0),g(V,null,ie(u.value,(le,Ye)=>(d(),g("span",{class:"cursor-pointer",key:le.doc_id+"_"+Ye,onClick:lt=>R(le)},[a("h4",Fl,M(le.title),1)],8,$l))),128)),te(p(w,null,{icon:m(()=>[Kl]),title:m(()=>[Ul]),_:1},512),[[he,l.value&&!_.value&&!u.value.length]])])),[[he,l.value],[W,_.value]])],512)]),_:1},8,["virtual-ref"])}}});var Gl=Z(Vl,[["__scopeId","data-v-59b62b74"]]);let Je=null;const Is=()=>{Je&&Je.visible.value||(Je=Mo.service({lock:!0,background:"rgba(255, 255, 255, 1)"}))},me=()=>{Je&&Je.close()};var Hl=ee({components:{AcTree:jl,Plus:vn,Search:Oo,MoreFilled:xo,SearchDocumentPopover:Gl},setup(){const e=ge("documentShareModal"),t=ge("documentImportModal"),s=ge("projectExportModal"),o=Vt(),n=tt(),{currentRoute:i}=n,{params:r}=o,ro=_s(),{isIterateRoute:c}=ro,l=fo(ro,["isIterateRoute"]),_=ys(),{apiDocTree:f}=ne(_),u=re(),y=Ne(),{isManager:A,isDeveloper:h,projectInfo:C}=ne(u),k=vs,S=b(null),P=b(null),R=b(null),F=b(),N=b(null),G=b(null);let H=1;const Q=null,w=Me(()=>i.value.name===Le||i.value.name===Ie);pe(()=>o.params.node_id,()=>ze());const U=(L,x,oe)=>{if(oe.target.tagName!=="INPUT"){if(x.isLeaf){W(x);return}L.expanded=!L.expanded}},W=L=>{const{node_id:x}=i.value.params;w.value&&L.id===parseInt(x,10)||(ze(L.id),n.push({name:y.isIterateRoute?He:Le,params:Y(D({},r),{node_id:L.id})}))},le=(L,x,oe,de)=>{L.stopPropagation(),S.value=oe.id,Rt.show(de,L.target,{node:x,source:oe,isDetailPage:w.value},G.value)},Ye=L=>{var x;le(L,(x=R.value)==null?void 0:x.root,f.value,"DIR_NEW_TYPE")},lt=qs(function(L){let x=0;return Re(oe=>{oe.isLeaf||x++},[L],{subKey:"sub_nodes"}),x}),At=(L,x,oe)=>{const{data:de}=x,{data:se}=L;return de.isLeaf&&oe==="inner"?!1:!se.isLeaf&&!de.isLeaf?lt(se)+x.level<=5:!0},I=L=>{const x=[L.isLeaf?"is-doc":"is-dir"];return L.selected===!1&&x.push("hidden"),x.join(" ")},K=L=>L.type===xe.DOC,ye=async()=>{var L;await mt(),P.value&&(mo(P.value,{scrollMode:"if-needed"}),P.value.focus(),P.value.setSelectionRange(0,(L=P.value)==null?void 0:L.value.length))},De=L=>{L.target&&L.target.blur()},bs=Ht(function(L,x){if(x.isEditable=!1,!L.target.value&&x._oldName){x.title=x._oldName;return}const oe=x.type===xe.DIR,de=oe?hl:ja,se={project_id:C.value.id,title:x.title};se[oe?"node_id":"doc_id"]=x.id,de(se).then(()=>{delete x._oldName}).catch(()=>{x._oldName&&(x.title=x._oldName)})},200),ze=L=>{var co,lo;Re(uo=>{if(uo.isCurrent)return uo.isCurrent=!1,!1},f.value,{subKey:"sub_nodes"});const{node_id:x}=i.value.params,de=parseInt(L||x,10),se=(co=R.value)==null?void 0:co.getNode(de);se&&(se.data.isCurrent=!0,(lo=R.value)==null||lo.setCurrentKey(de));const ao=document.querySelector("#tree_node_"+de);ao&&mo(ao,{scrollMode:"if-needed"})},io=()=>{if(!R.value)return;let L=!1;if(Re(x=>{if(x.isCurrent)return L=!0,!1},f.value,{subKey:"sub_nodes"}),!L){let x=null;Re(de=>{let se=R.value.getNode(de.id);if(c){if(se&&se.data.isLeaf&&se.data.selected)return x=se,!1}else if(se&&se.data.isLeaf)return x=se,!1},f.value,{subKey:"sub_nodes"}),x?(r.node_id=x.key,ze(x.key)):me();const oe=G.value;oe==null||oe.scrollTo(0,0),n.replace({name:y.isIterateRoute?He:Le,params:r})}},Ns=async()=>{const L=await _.getApiDocTree(Ee(l));(!L||!L.length)&&me()};return et(async()=>{await Ns(),r.node_id?ze():io()}),{isManager:A,isDeveloper:h,router:n,index:H,oldDraggingNodeInfo:Q,params:r,projectInfo:C,publicParams:l,isIterateRoute:c,apiDocTree:f,renameInput:P,dir:G,activeMoreNodeId:S,treeIns:R,newMenus:k,documentShareModal:e,createDocIcon:gs,handleTreeNodeClick:U,onRootMoreIconClick:Ye,onMoreIconClick:le,allowDrop:At,customNodeClass:I,customNodeLeaf:K,onEnterKeyUp:De,setUnEditable:bs,inputFocus:ye,activeNode:ze,reactiveNode:io,documentImportModal:t,projectExportModal:s,searchDocumentPopoverRef:N,searchIconRef:F}},mounted(){Rt.onPopperItemClick=({menu:e,node:t,source:s})=>this.onPopperItemClick(e,t,s),Rt.onPopperHide=()=>{this.activeMoreNodeId=null}},methods:{onPopperItemClick(e,t,s){const o=this[e.onClick];o&&o(t||this.treeIns.root,s||{sub_nodes:this.apiDocTree,id:0},e)},onRenameBtnClick(e,t){t._oldName=t.title,t.isEditable=!0,this.inputFocus()},onDeleteBtnClick(e,t){let s=!t.isLeaf;es({title:"\u5220\u9664\u63D0\u793A",content:p("div",{class:"break-all"},[J("\u786E\u5B9A\u5220\u9664\u300C"),t.title,J("\u300D"),s?"\u5206\u7C7B":"\u6587\u6863",J("\u5417\uFF1F")]),onOk:()=>{const o=t.type===xe.DIR,n=o?ul:Ra;let i=D({},Ee(this.publicParams));return i[o?"node_id":"doc_id"]=t.id,n(i).then(r=>{fe.success(r.msg||"\u5220\u9664\u6210\u529F\uFF01"),this.treeIns.remove(e),this.reactiveNode()})}})},onCreateDirBtnClick(e,t){let s=Y(D({},Ee(this.publicParams)),{name:"\u65B0\u5EFA\u5206\u7C7B"+this.index++});t.id&&(s.parent_id=t.id,s.pid=t.id),Ae.start(),dl(s).then(o=>{const n=ut(o.data,xe.DIR);!e.parent&&e.level===0?t.unshift(n):!t.sub_nodes||!t.sub_nodes.length?this.treeIns.append(n,e):this.treeIns.insertBefore(n,t.sub_nodes[0]),this.$nextTick(()=>{const i=this.treeIns.getNode(t);i&&(i.expanded=!0);const r=this.treeIns.getNode(o.data);r.data.isEditable=!0,setTimeout(()=>this.inputFocus(),100)})}).finally(()=>{Ae.done()})},createDoc(e,t){let s=Y(D({},Ee(this.publicParams)),{parent_id:e.key,pid:e.key});Ae.start(),Da(s).then(({data:o})=>{this.treeIns.append(ut(o),e),this.$nextTick(()=>{this.treeIns.setCurrentKey(o.id);const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.router.push({name:this.isIterateRoute?Ie:Te,params:Y(D({},this.params),{node_id:o.id}),query:{isNew:!0}}),this.activeNode(o.id)})}).finally(()=>{Ae.done()})},onMoveNodeStart(e){const t=e.parent;this.oldDraggingNodeInfo={oldPid:t.id===0?null:t.key,oldChildIds:t.childNodes.filter(s=>s.id!==e.id).map(s=>s.key)}},onMoveNode(e,t,s){if(!this.oldDraggingNodeInfo)return;const{oldPid:o,oldChildIds:n}=this.oldDraggingNodeInfo;let i=o===t.parent.id&&s!=="inner";const r=this.treeIns.getNode(e.data).parent,c=r.id===0?null:r.key,l=r.childNodes.map(f=>f.key),_={oldPid:i?c:o,oldChildIds:i?l:n,newPid:c,newChildIds:l};this.oldDraggingNodeInfo=null,pl({new_pid:_.newPid||0,new_node_ids:_.newChildIds,old_pid:_.oldPid||0,old_node_ids:_.oldChildIds,project_id:this.projectInfo.id})},onCopyBtnClick(e,t){Ae.start(),Sa(Y(D({},Ee(this.publicParams)),{doc_id:t.id})).then(({data:s})=>{this.treeIns.insertAfter(ut(s),e),this.router.push({name:this.isIterateRoute?Ie:Te,params:Y(D({},this.params),{node_id:s.id})})}).finally(()=>{Ae.done()})},onShareBtnClick(e,t){this.documentShareModal.show({docId:t.id,nodeId:t.id})},onImportBtnClick(e,t){this.documentImportModal.show(Y(D({},Ee(this.publicParams)),{parent_id:t.id?t.id:0}),Oa)},onExportBtnClick(e,t){this.projectExportModal.title="\u5BFC\u51FA\u6587\u6863",this.projectExportModal.show({project_id:this.projectInfo.id,doc_id:t.id},fs)},updateTreeNode(e,t={title:""}){let s=this.treeIns.getNode(e);s&&s.data.title&&(s.data.title=t.title||s.title)},createHttpDoc(e,t){let s=Y(D({},Ee(this.publicParams)),{parent_id:e.key,pid:e.key});Ae.start(),Pa(s).then(({data:o})=>{o.title=o.name,this.treeIns.append(ut(o),e),this.$nextTick(()=>{const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.router.push({name:this.isIterateRoute?Ie:Te,params:Y(D({},this.params),{node_id:o.id}),query:{isNew:!0}})})}).finally(()=>{Ae.done()})}}});const Yl={class:"flex flex-col h-full"},zl={class:"ac-doc-catalog"},Jl=a("h3",{class:"text-base font-medium"},"\u76EE\u5F55",-1),ql={class:"flex-auto overflow-x-scroll scroll-content",ref:"dir"},Wl=a("div",{class:"el-tree-node__bg"},null,-1),Zl=["onClick"],Ql=["id"],Xl=["src"],ed=["title"],td=["id","onUpdate:modelValue","maxlength","onBlur"],od=a("span",{class:"mx-1"},null,-1);function sd(e,t,s,o,n,i){const r=X("Search"),c=$e,l=X("Plus"),_=X("plus"),f=X("more-filled"),u=X("ac-tree"),y=X("SearchDocumentPopover");return d(),g(V,null,[a("div",Yl,[a("div",zl,[Jl,a("div",null,[p(c,{class:B(["cursor-pointer text-zinc-500",{"mr-5":e.isManager||e.isDeveloper}]),ref:"searchIconRef"},{default:m(()=>[p(r)]),_:1},8,["class"]),e.isManager||e.isDeveloper?(d(),$(c,{key:0,class:"cursor-pointer text-zinc-500",onClick:e.onRootMoreIconClick},{default:m(()=>[p(l)]),_:1},8,["onClick"])):T("",!0)])]),a("div",ql,[p(u,{data:e.apiDocTree,class:"bg-transparent","node-key":"id","empty-text":"",draggable:e.isManager||e.isDeveloper,ref:"treeIns","expand-on-click-node":!1,props:{children:"sub_nodes",label:"title",class:e.customNodeClass,isLeaf:e.customNodeLeaf},"allow-drop":e.allowDrop,onNodeDragStart:e.onMoveNodeStart,onNodeDrop:e.onMoveNode},{default:m(({node:A,data:h})=>[Wl,a("div",{class:B(["flex justify-between ac-tree-node",{"is-editable":h.isEditable}])},[a("div",{class:"ac-tree-node__main",onClick:C=>e.handleTreeNodeClick(A,h,C)},[a("div",{class:B(["ac-doc-node",{"is-active":h.isCurrent}]),id:"tree_node_"+h.id},[h.isLeaf?(d(),g("img",{key:0,class:"ac-doc-node__icon",src:e.createDocIcon},null,8,Xl)):T("",!0),te(a("span",{class:"ac-doc-node__label",title:h.title},M(h.title),9,ed),[[he,!h.isEditable]]),h.isEditable?te((d(),g("input",{key:1,type:"text",ref:"renameInput",class:"ac-doc-node__input el-input el-input__inner",id:"tree_input_"+h.id,"onUpdate:modelValue":C=>h.title=C,onKeyup:t[0]||(t[0]=jo((...C)=>e.onEnterKeyUp&&e.onEnterKeyUp(...C),["enter"])),maxlength:h.isLeaf?255:50,onBlur:C=>e.setUnEditable(C,h)},null,40,td)),[[So,h.title]]):T("",!0)],10,Ql)],8,Zl),e.isManager||e.isDeveloper?(d(),g("div",{key:0,class:B(["ac-tree-node__more",{active:h.id===e.activeMoreNodeId}])},[te(p(c,{onClick:C=>e.onMoreIconClick(C,A,h,"DIR_NEW_TYPE")},{default:m(()=>[p(_)]),_:2},1032,["onClick"]),[[he,!h.isLeaf]]),od,te(p(c,{onClick:C=>e.onMoreIconClick(C,A,h,"DIR_OPERATE_TYPE")},{default:m(()=>[p(f)]),_:2},1032,["onClick"]),[[he,!h.isLeaf]]),te(p(c,{onClick:C=>e.onMoreIconClick(C,A,h,"DOC_OPERATE_TYPE")},{default:m(()=>[p(f)]),_:2},1032,["onClick"]),[[he,h.isLeaf]])],2)):T("",!0)],2)]),_:1},8,["data","draggable","props","allow-drop","onNodeDragStart","onNodeDrop"])],512)]),p(y,{ref:"searchDocumentPopoverRef","virtual-ref":e.searchIconRef},null,8,["virtual-ref"])],64)}var nd=Z(Hl,[["render",sd]]);const id=(e={})=>Mt.post("/upload_path",e),xt={},Qu=e=>new Promise((t,s)=>{const o={complete:!1,width:0,height:0,src:e};if(!e){s(o);return}if(xt[e]){t(D({},xt[e]));return}const n=new Image;n.onload=()=>{o.width=n.width,o.height=n.height,o.complete=!0,xt[e]=D({},o),t(o)},n.onerror=()=>{s(o)},n.src=e});function _e(){this.chunkSize=1024*1024,this.threadsQuantity=2,this.timeout=1e3*10,this.file=null,this.aborted=!1,this.uploadedSize=0,this.progressCache={},this.activeConnections={},this.taskConfig={}}_e.prototype.setOptions=function(e={}){this.chunkSize=e.chunkSize||this.chunkSize,this.threadsQuantity=e.threadsQuantity||this.threadsQuantity};_e.prototype.setupFile=function(e){!e||(this.file=e)};_e.prototype.start=function(){if(!this.file)throw new Error("Can't start uploading: file have not chosen");const e=Math.ceil(this.file.size/this.chunkSize);this.chunksQueue=new Array(e).fill().map((o,n)=>n).reverse();const t=new XMLHttpRequest;t.timeout=this.timeout,t.open("post","/api/upload_init"),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.setRequestHeader("Accept","application/json, text/plain, */*");let s=j.get(j.KEYS.TOKEN)||"";s&&t.setRequestHeader("Authorization",s),t.withCredentials=!0,t.onreadystatechange=()=>{if(t.readyState===XMLHttpRequest.DONE&&t.status===200){const{status:o,msg:n,data:i}=JSON.parse(t.responseText);if(o!==0){this.complete(new Error(n||"\u4E0A\u4F20\u521D\u59CB\u5316\u5931\u8D25\uFF01"));return}this.fileId=i.file_id,this.sendNext()}},t.onerror=o=>{this.complete(o)},t.ontimeout=o=>{this.complete(o)},t.send(JSON.stringify({name:this.file.name,chunks:e,fileSize:Math.ceil(this.file.size/1024)}))};_e.prototype.sendNext=function(){const e=Object.keys(this.activeConnections).length;let t=!1;if(Object.keys(this.taskConfig).forEach(i=>{this.taskConfig[i].retryCount>=3&&(t=!0)}),t){this.complete(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01"));return}if(e>=this.threadsQuantity)return;if(!this.chunksQueue.length){e||this.getResult();return}const s=this.chunksQueue.pop(),o=s*this.chunkSize,n=this.file.slice(o,o+this.chunkSize);this.sendChunk(n,s).then(()=>this.sendNext()).catch(i=>{this.chunksQueue.push(s);let r=this.taskConfig[s];r&&r.retryCount<=3?this.sendNext():this.complete(i)}),this.sendNext()};_e.prototype.complete=function(e){const t=e&&e.message||e;if(e&&!this.aborted){this.end(t);return}this.end(t)};_e.prototype.sendChunk=function(e,t){return this.upload(t,e)};_e.prototype.handleProgress=function(e,t){(t.type==="progress"||t.type==="error"||t.type==="abort")&&(this.progressCache[e]=t.loaded),t.type==="loadend"&&(this.uploadedSize+=this.progressCache[e]||0,delete this.progressCache[e]);const s=Object.keys(this.progressCache).reduce((n,i)=>n+=this.progressCache[i],0),o=Math.min(this.uploadedSize+s,this.file.size);this.onProgress&&this.onProgress({loaded:o,total:this.file.size})};_e.prototype.upload=function(e,t){return new Promise((s,o)=>{let n=this.taskConfig[e]=this.taskConfig[e]||{retryCount:0};const i=this.activeConnections[e]=new XMLHttpRequest;i.timeout=this.timeout;const r=this.handleProgress.bind(this,e);i.upload.addEventListener("progress",r),i.addEventListener("error",r),i.addEventListener("abort",r),i.addEventListener("loadend",r),i.open("post","/api/upload_save"),i.setRequestHeader("Accept","application/json, text/plain, */*");let c=j.get(j.KEYS.TOKEN)||"";c&&i.setRequestHeader("Authorization",c),i.onreadystatechange=()=>{if(delete this.activeConnections[e],i.readyState===XMLHttpRequest.DONE&&i.status===200){const _=JSON.parse(i.responseText);if(_.status!==0){o(new Error(_.msg||"\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++;return}_.status===0&&s(_)}i.readyState===XMLHttpRequest.DONE&&i.status!==200&&(o(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++)},i.onerror=_=>{o(_),delete this.activeConnections[e]},i.onabort=()=>{o(new Error("\u53D6\u6D88\u4E0A\u4F20\uFF01")),delete this.activeConnections[e]},i.ontimeout=_=>{o(_),delete this.activeConnections[e]};let l=new FormData;l.append("file_id",this.fileId),l.append("chunk_id",e),l.append("file",t),i.send(l)})};_e.prototype.on=function(e,t){typeof t!="function"&&(t=qe),this[e]=t};_e.prototype.abort=function(){Object.keys(this.activeConnections).forEach(e=>{this.activeConnections[e].abort()}),this.aborted=!0};_e.prototype.getResult=function(){id({file_id:this.fileId}).then(e=>this.end(null,e)).catch(e=>this.complete(e))};const rd=function(){const e=new _e;return{options:function(t){return e.setOptions(t),this},send:function(t){return e.setupFile(t),this},continue:function(){e.sendNext()},onProgress:function(t){return e.on("onProgress",t||qe),this},end:function(t){return e.on("end",t||qe),e.start(),this},abort:function(){e.abort()}}};const ad={props:{maxSize:{type:Number,default:1},multiple:{type:Boolean,default:!1}},data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u5165\u6587\u6863",params:{},jobParams:{id:null},importList:[],currentConfig:null,timer:null}},methods:{projectItemClass(e){return["ac-project-export-item","ac-project-export-file",{disabled:e.disabled}]},hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.importList=t||[],this.params=e||{}},onFileChange(e,t){this.currentConfig=t||{},this.validFile(e)&&this.upload()},validFile(e){const t=e.target.files;if(!t)return!1;let s=Array.prototype.slice.call(t);if(this.multiple||(s=s.slice(0,1)),s.length===0)return!1;let o=s[0];e.target.value=null;let{maxSize:n}=this.currentConfig;return n=n||this.maxSize,o.size>n*1024*1024?(this.$Message.error(`\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7${n}MB`),!1):(this.currentConfig.file=o,!0)},upload(){if(!this.currentConfig||!this.currentConfig.file)return this.$Message.error("\u672A\u9009\u62E9\u6587\u4EF6\uFF01");this.isLoading=!0,rd().options().send(this.currentConfig.file).end((e,t)=>{if(e){this.isLoading=!1,this.$Message.error(e instanceof Error?e.message:e);return}this.currentConfig.fileUrl=t.data,this.getImportJobId(this.buildParams())})},getImportJobId(e){if(!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.currentConfig=null,this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult||!this.jobParams.id)return this.clearTimer(),Promise.resolve();try{const{data:e,msg:t}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);if(e.result===Ue.FAIL){this.$Message.error(t||"\u5BFC\u5165\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===Ue.WAIT)return;e.result===Ue.FINISH&&(this.$Message.success(t||"\u5BFC\u5165\u5B8C\u6210\uFF01"),this.clearTimer(),this.hide(),location.reload())}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(),await No(2e3)},buildParams(){return this.currentConfig?Y(D({},this.params),{filename:this.currentConfig.file?this.currentConfig.file.name:"\u672A\u547D\u540D",file:this.currentConfig.fileUrl,type:this.currentConfig.type}):{}}}},cd={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},ld={class:"ac-project-export-inner"},dd=["src","alt"],ud={class:"mt-1.5"},hd=["onChange","accept"];function pd(e,t,s,o,n,i){const r=ot,c=nt;return d(),$(r,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content",class:"vertical-center-modal","close-on-click-modal":!1,title:n.title,"append-to-body":""},{default:m(()=>[te((d(),g("div",cd,[(d(!0),g(V,null,ie(n.importList,l=>(d(),g("div",{class:B(i.projectItemClass(l)),key:l.type},[a("div",ld,[a("img",{src:l.icon,alt:l.text},null,8,dd),a("p",ud,M(l.text),1),a("input",{type:"file",onChange:_=>i.onFileChange(_,l),accept:l.accept},null,40,hd)])],2))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var fd=Z(ad,[["render",pd],["__scopeId","data-v-5eb02cdd"]]);const _d={class:"ac-doc-layout__left"},md={class:"ac-doc-layout__right scroll-content"},ws=ee({setup(e){const{currentRoute:t}=tt(),s=re(),{isGuest:o,isReader:n,isManager:i,isDeveloper:r,projectInfo:c}=ne(s),l=Ne(),{isIterateRoute:_,iterateInfo:f}=ne(l),u=b(),y=b(),A=b(),h=b(),C=b(""),k=Me(()=>["ac-doc-layout",{readonly:o.value||n.value}]),S=Me(()=>!isNaN(parseInt(t.value.params.node_id,10))),P=`<template id="template-zoom-image">
                            <div class="zoom-image-wrapper">
                                <div class="zoom-image-container" data-zoom-container></div>
                            </div>
                          </template>`;return ue("documentShareModal",A),ue("projectExportModal",u),ue("documentImportModal",y),ue("updateTreeNode",(R,F)=>h.value&&h.value.updateTreeNode(R,F)),ue("setDocumentTitle",R=>{document.title=c.value.name+(_.value?`(${f.value.title})`:"")+"-"+R,C.value=R}),(R,F)=>{const N=X("router-view"),G=wa;return d(),g(V,null,[v(c)?(d(),g("main",{key:0,class:B(v(k))},[v(o)?(d(),$(Nc,{key:0})):(d(),$(Ec,{key:1})),v(S)?(d(),g(V,{key:2},[v(i)||v(r)?(d(),$($c,{key:0,title:C.value},null,8,["title"])):T("",!0)],64)):T("",!0),a("div",_d,[p(nd,{ref_key:"directoryTree",ref:h},null,512)]),a("div",md,[p(N)])],2)):T("",!0),a("div",{innerHTML:P}),p(G,{ref_key:"projectExportModal",ref:u},null,512),p(fd,{ref_key:"documentImportModal",ref:y},null,512),p(Wa,{ref_key:"documentShareModal",ref:A},null,512)],64)}}}),gd=()=>q(()=>import("./DocumentDetail.84ca21c1.js"),["assets/DocumentDetail.84ca21c1.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/medium-zoom.esm.882d8c8d.js"]),vd=()=>q(()=>import("./DocumentEditor.fb62a3c0.js"),["assets/DocumentEditor.fb62a3c0.js","assets/DocumentEditor.b68616fa.css","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/params.cc02e58f.js"]),Xu=ae(to);ae(Go);var yd={path:jn,name:eo,component:ws,redirect:{name:Le},children:[{path:to,name:Le,meta:{ignoreAuth:!0},component:gd},{path:Go,name:Te,component:vd}]};const Ad=()=>q(()=>import("./DocumentDetail.84ca21c1.js"),["assets/DocumentDetail.84ca21c1.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/medium-zoom.esm.882d8c8d.js"]),Ed=()=>q(()=>import("./DocumentEditor.fb62a3c0.js"),["assets/DocumentEditor.fb62a3c0.js","assets/DocumentEditor.b68616fa.css","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/params.cc02e58f.js"]);var Cd={path:Ho,name:Yo,component:ws,redirect:{name:He},children:[{path:Jo,name:He,component:Ad},{path:zo,name:Ie,component:Ed}]};const kd=ee({setup(e){return(t,s)=>{const o=$e,n=yn;return d(),$(n,Ws(t.$attrs,{class:"ac-backtop"}),{default:m(()=>[p(o,null,{default:m(()=>[p(v(An))]),_:1})]),_:1},16)}}});var Id=Z(kd,[["__scopeId","data-v-de5b7756"]]);const wd={name:"ProjectSearch",data(){return{data:[],isLoading:!1,isNoData:!1,isShowSearchResult:!1,form:{token:j.get(j.KEYS.SECRET_PROJECT_TOKEN+this.$route.params.project_id||"",!0),project_id:this.$route.params.project_id,keywords:""}}},methods:{onClickSearchResult(e){let t=!1;Re(s=>{if(s.id===(e.node_id||e.doc_id))return t=!0,!1},[]),t?this.$router.push(e.link):location.href=e.href},onStop(e){e.stopPropagation()},onSearchDocument:Ht(function(){!Zs(Ro(this.form.keywords))&&this.form.keywords.length>=2&&(this.isLoading=!0,this.data=[],this.isShowSearchResult=!0,Ka(this.form.token,this.form.project_id,this.form.keywords).then(e=>{this.data=(e.data||[]).map(t=>(t.link={name:"preview.project.document",params:{project_id:this.form.project_id,node_id:t.node_id||t.doc_id}},t.href=`/app/${this.form.project_id}/${t.node_id||t.doc_id}`,t)),this.isNoData=!this.data.length}).finally(()=>{this.isLoading=!1}))},300)},created(){document.body.addEventListener("click",e=>{this.data=[],this.form.keywords="",this.isShowSearchResult=!1})}},bd={class:"search-popper-input"},Nd=a("i",{class:"icon iconfont iconsousuo"},null,-1),Dd={style:{padding:"10px","text-align":"center"}},Pd={key:0},Sd=["onClick","title"],jd={key:1,class:"result p-2"},Rd=a("div",{class:"result-icon"},[a("img",{src:Cs,alt:""})],-1),xd=a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1),Td=[Rd,xd];function Ld(e,t,s,o,n,i){return d(),g("div",{class:"search-popper",onClick:t[3]||(t[3]=(...r)=>i.onStop&&i.onStop(...r))},[a("div",bd,[te(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>n.form.keywords=r),placeholder:"\u641C\u7D22",maxlength:"255",onKeyup:t[1]||(t[1]=jo((...r)=>i.onSearchDocument&&i.onSearchDocument(...r),["enter"]))},null,544),[[So,n.form.keywords]]),Nd]),te(a("div",{class:"search-popper-result scroll-content",onClick:t[2]||(t[2]=(...r)=>i.onStop&&i.onStop(...r))},[te(a("div",Dd,"\u641C\u7D22\u4E2D...",512),[[he,n.isLoading]]),n.data.length?(d(),g("ul",Pd,[(d(!0),g(V,null,ie(n.data,r=>(d(),g("li",{key:r.node_id},[a("a",{href:"javascript:void(0);",onClick:c=>i.onClickSearchResult(r),title:r.title},M(r.title),9,Sd)]))),128))])):T("",!0),n.isNoData?(d(),g("div",jd,Td)):T("",!0)],512),[[he,n.isShowSearchResult]])])}var Od=Z(wd,[["render",Ld]]);const Md={name:"PreviewHeader",props:{isShowSearch:{type:Boolean,default:!0}},components:{ProjectSearch:Od}},Bd={class:"header header-fixed"},$d=Qs('<a class="logo" href="/"><img src="'+rt+'" alt="ApiCat"><span class="logo"><span class="logo-text logo-apicat">ApiCat</span></span></a><ul class="header-nav"></ul>',2);function Fd(e,t,s,o,n,i){const r=X("project-search");return d(),g("header",Bd,[$d,s.isShowSearch?(d(),$(r,{key:0})):T("",!0)])}var Kd=Z(Md,[["render",Fd]]);const no=ee({setup(e){const t=b(!0),s=b(!0),o=i=>{t.value=i},n=i=>{s.value=i};return ue("showSearchInput",o),ue("showHeader",n),(i,r)=>{const c=X("router-view"),l=Id;return d(),g(V,null,[s.value?(d(),$(Kd,{key:0,"is-show-search":t.value},null,8,["is-show-search"])):T("",!0),p(c),p(l,{bottom:100,right:100})],64)}}}),Ud=()=>q(()=>import("./ProjectVerification.1c7cc599.js"),["assets/ProjectVerification.1c7cc599.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/img_join.8db8ddd5.js"]),Vd=()=>q(()=>import("./DocumentPreview.c2f88dc0.js"),["assets/DocumentPreview.c2f88dc0.js","assets/AcEditorDocument.0d24a967.js","assets/vendor.4578470d.js","assets/medium-zoom.esm.882d8c8d.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css"]),Gd=()=>q(()=>import("./DocumentVerification.6545e1c4.js"),["assets/DocumentVerification.6545e1c4.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/img_join.8db8ddd5.js"]),Hd=()=>q(()=>import("./TrashDocumentPreview.6c0a6106.js"),["assets/TrashDocumentPreview.6c0a6106.js","assets/element-plus.ccbabc0c.js","assets/element-plus.8e6ef202.css","assets/vendor.4578470d.js","assets/AcEditorDocument.0d24a967.js","assets/medium-zoom.esm.882d8c8d.js"]);ae("/app/:project_id");const eh=ae("/doc/:project_id/trash_api_preview/:doc_id"),Yd={path:"/doc",name:Ze,component:no,meta:{ignoreAuth:!0},children:[{path:"/doc/:doc_id",name:`${Ze}.detail`,component:Vd,meta:{ignoreAuth:!0}},{path:"/doc/:doc_id/verification",name:gt,component:Gd,meta:{ignoreAuth:!0}}]},zd={path:"/app",name:Qt,component:no,meta:{ignoreAuth:!0},children:[{path:"/app/:project_id/verification",name:Xt,component:Ud,meta:{ignoreAuth:!0}}]},Jd={path:"/doc/:project_id/trash_api_preview/:doc_id",name:"preview.trash",component:no,children:[{path:"",name:"preview.trash.document",component:Hd}]};function qd(e){e.beforeEach(async(t,s,o)=>{const i=we().isLogin;if(t.meta.ignoreAuth){if(i&&(t.path===We||t.path===Zt)){o(it);return}o();return}if(!i){o({path:We,replace:!0});return}o()})}function Wd(e){e.beforeEach(async(t,s,o)=>{const n=re();if(!Eo.some(r=>r.name===t.name)||n.projectInfo&&t.params.project_id===String(n.projectInfo.id))return o();let i=null;Is();try{const r=parseInt(t.params.project_id),c=await n.getProjectDetail(r);Eo.filter(f=>f.meta.role.indexOf(c.authority)!==-1).some(f=>f.name===t.name)||(i=be),await n.getProjectAuth(r)}catch{i=be}finally{me()}return i?o(i):o()})}const Zd=e=>{e.beforeEach(async(t,s,o)=>{const n=re();if(!t.matched.find(r=>r.name===eo))return o();const i=parseInt(t.params.project_id,10);if(n.projectAuthInfo&&n.projectAuthInfo.id===i)return o();try{const r=await n.getProjectAuth(i);if(!r||!r.id)return Bt(),!1}catch{return!1}return o()})},Qd=e=>{e.beforeEach(async(t,s,o)=>{const n=re();if(!t.matched.find(r=>r.name===eo))return o();const i=parseInt(t.params.project_id,10);if(n.projectInfo&&n.projectInfo.id===i)return o();try{await n.getProjectDetail(i)}catch{return!1}return o()})};function Xd(e){e.beforeEach(async(t,s,o)=>t.name===Te&&re().isReader?(me(),o(be)):o())}function eu(e){e.beforeEach(async(t,s,o)=>{const{name:n,params:i}=t;if(n===Le){const r=re(),{isLogin:c}=we(),l=!!j.get(j.KEYS.SECRET_PROJECT_TOKEN+i.project_id,!0),{projectAuthInfo:_,isPrivate:f}=ne(r),{has_shared:u,in_this:y}=v(_),A=v(f);if(!A){o();return}if(c&&y){o();return}if(!c&&A&&!u){me(),o(be);return}if(A&&!u&&c&&!y){me(),o(be);return}if(A&&!u&&c&&y){o();return}if(A&&u&&!l){me(),o({name:Xt,params:{project_id:i.project_id}});return}if(A&&u&&l){o();return}return me(),o(be)}return o()})}const tu=e=>{e.beforeEach(async(t,s,o)=>{const n=re(),i=Ne();if(i.isIterateRoute=!1,!t.matched.find(c=>c.name===Yo))return o();i.isIterateRoute=!0;const r=t.params.iterate_id;if(i.iterateInfo&&i.iterateInfo.id===r)return o();try{const c=await i.getIterateInfo(r);if(!c||!c.id)return Bt(),!1;const l=await n.getProjectDetailById({iteration_id:r});if(!l||!l.id)return Bt(),!1;await n.getProjectAuth(l.id)}catch{return!1}return o()})};function ou(e){e.beforeEach(async(t,s,o)=>{const{name:n}=t;if(n===He){const i=re(),{projectAuthInfo:r,isPrivate:c}=ne(i),{has_shared:l,in_this:_}=v(r),f=v(c),{isLogin:u}=we();if(!f){o();return}if(u&&_){o();return}if(!u&&f&&!l||f&&!l&&u&&!_)return!1;if(f&&!l&&u&&_){o();return}return!1}return o()})}function su(e){e.beforeEach(async(t,s,o)=>t.name===Ie&&re().isReader?!1:o())}function nu(e){e.beforeEach(async(t,s,o)=>{const{name:n,params:i}=t,r=!!j.get(j.KEYS.SECRET_DOCUMENT_TOKEN+i.doc_id,!0);if(String(n).startsWith(Ze)){if(!Xs(i.doc_id))return o(be);Is();const{data:c}=await Ba(i.doc_id);return c?n===gt?(me(),o()):r?o():(me(),o({name:gt,params:{doc_id:i.doc_id}})):(me(),o(be))}o()})}const iu=e=>{qd(e),Zd(e),Xd(e),eu(e),Qd(e),nu(e),Wd(e),tu(e),ou(e),su(e)},ke=en({history:tn("/"),routes:[ia,ra,aa,yd,Cd,{path:it,name:"main",component:Ir,redirect:{name:"projects"},children:[Si,ha,er,va,Qi]},zd,Yd,Jd,ca]});var ru=e=>{e.use(fe),e.use(Jt),e.use(gi),e.use(Mo),e.config.globalProperties.$Message=fe};const au=function(e){e.mixin({mounted:function(){e.__clipboard__&&e.__clipboard__.destroy(),e.__clipboard__=new on(".copy_text",{text:function(t){return Ro(t.getAttribute("data-text")||t.innerText||"")}}),e.__clipboard__.on("success",()=>{fe.closeAll(),fe.success("\u590D\u5236\u6210\u529F")})}})};var cu={install:au};class lu{constructor(){this._pendingMap=new Map}gatherKey(t){return[t.url,t.method,JSON.stringify(t.params)].join("_")}add(t){this.remove(t);const s=vt.CancelToken.source();t.cancelToken=t.cancelToken||s.token;const o=this.gatherKey(t);this._pendingMap.set(o,s.cancel)}remove(t){const s=this.gatherKey(t);if(this._pendingMap.has(s)){const o=this._pendingMap.get(s);o&&go(o)&&o(),this._pendingMap.delete(s)}}removeAll(){this._pendingMap.forEach(t=>t&&go(t)&&t()),this.clear()}clear(){this._pendingMap.clear()}}const du=Be({id:"preview",state:()=>({projectInfo:null,documentInfo:null}),getters:{},actions:{async getProjectInfo(e){const{data:t}=await Fa(e);return this.projectInfo=t||null,this.projectInfo},async getDocumentInfo(e){const t=j.get(j.KEYS.SECRET_DOCUMENT_TOKEN+e,!0)||"",{data:s}=await $a(e,t);return this.documentInfo=s||null,this.documentInfo},goVerificationPage(){const e=ke.currentRoute.value.params.project_id||"",t=ke.currentRoute.value.params.doc_id||"",s=ke.currentRoute.value.name||"";if(s.includes(Qt)){j.remove(j.KEYS.SECRET_PROJECT_TOKEN+e,!0),ke.push({name:Xt,params:{project_id:e}});return}s.includes(Ze)&&(j.remove(j.KEYS.SECRET_DOCUMENT_TOKEN+t,!0),ke.push({name:gt,params:{document_id:t}}))}}}),pt=new lu,uu=()=>{E.interceptors.request.use(e=>{pt.add(e);const t=we().token;return t&&(e.headers=Y(D({},e.headers),{Authorization:t})),e}),E.interceptors.response.use(e=>{pt.remove(e.config);let t="";!e.data&&(e.data={});const s=e.data.status;switch(e.headers.authorization&&we().updateToken(e.headers.authorization),s){case Ke.NO_LOGIN:t="\u767B\u5F55\u72B6\u6001\u5DF2\u5931\u6548\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55",pt.removeAll(),we().logout();break;case Ke.INVALID_PREVIEW_SECRET:t=e.data.msg||"\u8BBF\u95EE\u79D8\u94A5\u5DF2\u5931\u6548\u3002",pt.removeAll(),du().goVerificationPage();break;case Ke.OK:case Ke.NO_PARENT_DIR:case Ke.NOT_FOUND:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject({message:t}):e.data}),E.interceptors.response.use(void 0,e=>{var i,r;let t="";const{code:s,message:o}=e||{},n=(r=(i=e==null?void 0:e.toString)==null?void 0:i.call(e))!=null?r:"";return t=o,s==="ECONNABORTED"&&t.indexOf("timeout")!==-1&&(t="\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5"),n!=null&&n.includes("Network Error")&&(t="\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u91CD\u8BD5"),fe.closeAll(),t&&fe.error(t),Promise.reject(e)}),Mt.interceptors.request.use(e=>{const t=we().token;return t&&(e.headers=Y(D({},e.headers),{Authorization:t})),e}),Mt.interceptors.response.use(e=>{let t;switch(!e.data&&(e.data={}),e.data.status){case 0:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject(t):e.data},e=>(e.message.indexOf("timeout")!==-1&&fe.error("\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5\uFF01"),Promise.reject(e)))};uu();const ct=sn(Sn);ct.use(nn());ct.use(ke);ct.use(cu);iu(ke);ru(ct);ct.mount("#app");export{me as $,E as A,re as B,Eo as C,xe as D,Nu as E,vu as F,Pu as G,Du as H,Su as I,bu as J,Mu as K,We as L,it as M,ju as N,Ma as O,mu as P,Zu as Q,Zt as R,oo as S,On as T,Ke as U,Ou as V,eh as W,_s as X,Ee as Y,Oa as Z,rt as _,we as a,Yu as a0,Se as a1,Dc as a2,Ml as a3,Id as a4,q as a5,rd as a6,Qu as a7,Gu as a8,Hu as a9,zu as aa,xc as ab,Tc as ac,Pc as ad,Sc as ae,jc as af,ja as ag,Rc as ah,Ne as ai,xu as aj,Fu as ak,$u as al,fl as am,Uu as an,Bu as ao,Ru as ap,Ku as aq,Vu as ar,Wu as as,yo as at,du as au,Is as av,Ju as aw,qu as ax,_u as b,Z as c,Ve as d,es as e,yu as f,gu as g,Qo as h,ku as i,Cu as j,Lu as k,z as l,Eu as m,wa as n,nc as o,li as p,ci as q,Ln as r,Au as s,Ce as t,qo as u,Iu as v,wu as w,ps as x,Tu as y,Xu as z};
