var T=Object.defineProperty;var V=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var S=(t,e,n)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,v=(t,e)=>{for(var n in e||(e={}))I.call(e,n)&&S(t,n,e[n]);if(V)for(var n of V(e))O.call(e,n)&&S(t,n,e[n]);return t};import{J as U,K as q,g as D,h as R,F as Y,i as K,f as L,j as N,E as J,L as z,M as H,I as Q,v as W}from"./element-plus.33434d3d.js";import{u as G,a as X,d as Z,g as $}from"./params.f200ea60.js";import{b as ee,J as B,y as P,d as te}from"./index.0747997f.js";import{bd as oe,b0 as x,au as le,o as w,V as k,W as a,Y as l,Q as M,e as se,an as ae,T as ne,am as ie,ab as f,d as re,r as E,aU as ue,v as de,f as b,_ as me}from"./vendor.1b70e788.js";const j={name:"",type:B.TYPES[0].value,is_must:!0,default_value:"",description:""},pe={emits:["on-ok"],directives:{param:{bind:function(t){let e=t.querySelector("input");e.removeEventListener("input",t.handler),t.handler=function(n){n.preventDefault();for(var c=new RegExp("[`~!#%^&*()=|{}':;',<>/?~\uFF01#\uFFE5\u2026\u2026&*\uFF08\uFF09|{}\u3010\u3011\u2018\uFF1B\uFF1A\u201D\u201C'\u3002\uFF0C\u3001\uFF1F]"),o="",r=0;r<this.value.length;r++)o=o+this.value.substr(r,1).replace(c,"");this.value=o.replace(/[^\w\.@$-\[\]]/gi,"")},e.addEventListener("input",t.handler)},unbind:function(t){t.querySelector("input").removeEventListener("input",t.handler)}}},data(){return{isShow:!1,isEdit:!1,isLoading:!1,types:B.TYPES,form:v({},j),rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",trigger:"blur"}}}},computed:v({},oe(P,{project:"projectInfo"})),watch:{isShow:function(){!this.isShow&&this.reset()}},methods:{onChange(t){this.form.name=t.target.value},show(t={}){!x(t)&&(this.form=t),this.isEdit=!x(t),this.isShow=!0},hide(){this.isShow=!1,this.reset(),this.form.name=""},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.form=v({},j),this.$refs.form.resetFields()},handleSubmit(t){this.$refs[t].validate(e=>e&&this.submit())},submit(){this.isLoading=!0;let t=this.isEdit?G:X;this.form.project_id=this.project.id,this.form.param_id=this.form.id||"",t(this.form).then(e=>{this.$Message.success(e.msg||(this.isEdit?"\u4FEE\u6539\u6210\u529F!":"\u6DFB\u52A0\u6210\u529F!")),this.onCloseBtnClick(),this.$emit("on-ok")}).catch(e=>{}).finally(()=>{this.isLoading=!1})}}},ce=f("\u662F\u5426\u5FC5\u9009"),fe=f("\u53D6\u6D88"),_e=f("\u786E\u5B9A");function he(t,e,n,c,o,r){const _=D,m=R,y=U,h=q,i=Y,u=K,p=L,d=N,C=le("param");return w(),k(d,{modelValue:o.isShow,"onUpdate:modelValue":e[8]||(e[8]=s=>o.isShow=s),width:400,"close-on-click-modal":!1,"append-to-body":"","custom-class":"show-footer-line vertical-center-modal",title:(o.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0")+"\u53C2\u6570"},{footer:a(()=>[l(p,{onClick:e[6]||(e[6]=s=>r.onCloseBtnClick())},{default:a(()=>[fe]),_:1}),l(p,{loading:o.isLoading,type:"primary",onClick:e[7]||(e[7]=s=>r.handleSubmit("form"))},{default:a(()=>[_e]),_:1},8,["loading"])]),default:a(()=>[l(u,{onKeyup:e[5]||(e[5]=ie(s=>r.handleSubmit("form"),["enter"])),ref:"form",model:o.form,rules:o.rules,"label-position":"top"},{default:a(()=>[l(m,{label:"\u53C2\u6570\u540D\u79F0",prop:"name",class:"hide_required"},{default:a(()=>[M(l(_,{onOnChange:r.onChange,modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.name=s),placeholder:"\u53C2\u6570\u540D\u79F0",maxlength:"100"},null,8,["onOnChange","modelValue"]),[[C]])]),_:1}),l(m,{label:"\u53C2\u6570\u7C7B\u578B",prop:"type"},{default:a(()=>[l(h,{modelValue:o.form.type,"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.type=s),placeholder:"\u53C2\u6570\u7C7B\u578B",class:"w-full"},{default:a(()=>[(w(!0),se(ne,null,ae(o.types,s=>(w(),k(y,{value:s.value,key:s.value,label:s.text},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"",prop:"is_must"},{default:a(()=>[l(i,{modelValue:o.form.is_must,"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.is_must=s)},{default:a(()=>[ce]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"\u9ED8\u8BA4\u503C",prop:"default_value",class:"hide_required"},{default:a(()=>[l(_,{modelValue:o.form.default_value,"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.default_value=s),placeholder:"\u9ED8\u8BA4\u503C",maxlength:"255"},null,8,["modelValue"])]),_:1}),l(m,{label:"\u53C2\u6570\u8BF4\u660E",prop:"description",class:"hide_required"},{default:a(()=>[l(_,{modelValue:o.form.description,"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.description=s),placeholder:"\u53C2\u6570\u540D\u79F0",type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"255"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var ve=ee(pe,[["render",he]]);const be=b("span",{innerHTML:"\xA0"},null,-1),ge={class:"absolute right-2",style:{top:"7px"}},we=f("\u6DFB\u52A0\u53C2\u6570"),ye=["onClick"],Ce=["onClick"];var je=re({setup(t){const e=E(),n=E([]),c=E(!1),o=P(),{projectInfo:r}=ue(o),_=()=>{var i;(i=e.value)==null||i.show()},m=i=>{var u;(u=e.value)==null||u.show(v({},i))},y=i=>{te({title:"\u5220\u9664\u63D0\u793A",content:l("div",{class:"truncate"},[f("\u786E\u5B9A\u5220\u9664\u53C2\u6570\u300C"),i.name,f("\u300D\u5417\uFF1F")]),onOk:()=>Z(o.projectInfo.id,i.id).then(u=>{J.success(u.msg||"\u5220\u9664\u6210\u529F\uFF01"),h()})})},h=async()=>{c.value=!0;try{const{data:i}=await $(o.projectInfo.id);let u=i.map||{};const p=[];Object.keys(u).forEach(d=>{u[d]&&p.push(u[d])}),n.value=p}catch{}finally{c.value=!1}};return de(()=>r.value,async()=>{r.value&&r.value.id&&await h()},{immediate:!0}),(i,u)=>{const p=L,d=z,C=H,s=Q,A=W;return M((w(),k(s,{shadow:"never","body-style":{padding:0}},{header:a(()=>[be,b("div",ge,[l(p,{type:"primary",onClick:_},{default:a(()=>[we]),_:1})])]),default:a(()=>[l(C,{data:n.value,"empty-text":"\u6682\u65E0\u6570\u636E"},{default:a(()=>[l(d,{prop:"name",label:"\u53C2\u6570\u540D\u79F0","show-overflow-tooltip":""}),l(d,{prop:"type_name",label:"\u53C2\u6570\u7C7B\u578B",width:"100"}),l(d,{prop:"is_must",label:"\u5FC5\u4F20",width:"70"},{default:a(g=>[b("span",null,me(g.is_must?"\u662F":"\u5426"),1)]),_:1}),l(d,{prop:"default_value",label:"\u9ED8\u8BA4\u503C",width:"100","show-overflow-tooltip":""}),l(d,{prop:"description",label:"\u53C2\u6570\u8BF4\u660E","show-overflow-tooltip":""}),l(d,{label:"\u64CD\u4F5C",width:"120"},{default:a(({row:g})=>[b("span",{class:"cursor-pointer mr-3 text-blue-600",onClick:F=>m(g)},"\u7F16\u8F91",8,ye),b("span",{class:"cursor-pointer mr-3 text-red-400",onClick:F=>y(g)},"\u5220\u9664",8,Ce)]),_:1})]),_:1},8,["data"]),l(ve,{ref_key:"modifyModal",ref:e,onOnOk:h},null,512)]),_:1})),[[A,c.value]])}}});export{je as default};
